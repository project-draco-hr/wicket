{
  final Component controller=getChildComponent();
  if (controller == this) {
    throw new WicketRuntimeException("Programming error: childComponent == enclose component; endless loop");
  }
  setVisible(controller.determineVisibility());
  DirectChildTagIterator it=new DirectChildTagIterator(markupStream,openTag);
  MarkupContainer controllerParent=getEnclosureParent();
  while (it.hasNext()) {
    ComponentTag t=(ComponentTag)it.next();
    Component child=controllerParent.get(t.getId());
    if (child != null) {
      child.setVisibilityAllowed(isVisible());
    }
  }
  it.rewind();
  if (isVisible() == true) {
    super.onComponentTagBody(markupStream,openTag);
  }
 else {
    markupStream.skipToMatchingCloseTag(openTag);
  }
}
