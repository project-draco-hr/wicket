{
  final StringBuffer buffer=new StringBuffer();
  int start;
  int pos=0;
  while ((start=string.indexOf("${",pos)) != -1) {
    buffer.append(string.substring(pos,start));
    pos=start;
    final int startVariableName=start + 2;
    final int endVariableName=string.indexOf('}',startVariableName);
    if (endVariableName != -1) {
      final String variableName=string.substring(startVariableName,endVariableName);
      final String value=getValue(variableName);
      if (value == null) {
        buffer.append("${" + variableName + "}");
      }
 else {
        buffer.append(value);
      }
      pos=endVariableName + 1;
    }
 else {
      break;
    }
  }
  if (pos < string.length()) {
    buffer.append(string.substring(pos));
  }
  return buffer.toString();
}
