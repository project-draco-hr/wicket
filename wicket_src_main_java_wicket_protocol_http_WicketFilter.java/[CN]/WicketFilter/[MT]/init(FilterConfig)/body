{
  this.filterConfig=filterConfig;
  final ClassLoader previousClassLoader=Thread.currentThread().getContextClassLoader();
  try {
    Thread.currentThread().setContextClassLoader(previousClassLoader);
    IWebApplicationFactory factory=getApplicationFactory();
    this.webApplication=factory.createApplication(this);
    this.webApplication.setWicketFilter(this);
    String contextKey="wicket:" + filterConfig.getFilterName();
    filterConfig.getServletContext().setAttribute(contextKey,this.webApplication);
    filterPath=filterConfig.getInitParameter(FILTER_PATH_PARAM);
    Application.set(webApplication);
    this.webApplication.internalInit();
    this.webApplication.init();
    this.webApplication.initializeComponents();
    this.webApplication.logStarted();
  }
  finally {
    Application.unset();
    Thread.currentThread().setContextClassLoader(previousClassLoader);
  }
}
