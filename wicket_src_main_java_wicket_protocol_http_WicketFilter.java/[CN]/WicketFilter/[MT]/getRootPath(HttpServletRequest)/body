{
  if (rootPath == null) {
    String path=webApplication.getApplicationSettings().getContextPath();
    if (path == null) {
      path=request.getContextPath();
      if (path == null) {
        path="";
      }
    }
    if (SERVLET_PATH_HOLDER.equals(filterPath)) {
      filterPath=request.getServletPath();
      if (filterPath.startsWith("/")) {
        filterPath=filterPath.substring(1);
      }
    }
    rootPath=path;
    if (filterPath != null) {
      if (!path.endsWith("/")) {
        rootPath=rootPath + "/" + filterPath;
      }
 else {
        rootPath=rootPath + filterPath;
      }
    }
  }
  return rootPath;
}
