{
  try {
    Class clazz=null;
    WeakReference ref=(WeakReference)classes.get(classname);
    if (ref != null) {
      clazz=(Class)ref.get();
    }
    if (clazz == null) {
synchronized (classes) {
        ClassLoader loader=Thread.currentThread().getContextClassLoader();
        if (loader == null) {
          loader=DefaultClassResolver.class.getClassLoader();
        }
        clazz=loader.loadClass(classname);
        classes.put(classname,new WeakReference(clazz));
      }
    }
    return clazz;
  }
 catch (  ClassNotFoundException ex) {
    throw new WicketRuntimeException("Unable to load class with name: " + classname,ex);
  }
}
