{
  String configLocation=portletapp.getWicketPortlet().getInitParameter("contextConfigLocation");
  GenericApplicationContext ctx=new GenericApplicationContext();
  XmlBeanDefinitionReader xmlReader=new XmlBeanDefinitionReader(ctx);
  Resource resource=new ClassPathResource(configLocation);
  if (!resource.exists()) {
    resource=new FileSystemResource(configLocation);
  }
  xmlReader.loadBeanDefinitions(resource);
  ctx.refresh();
  portletapp.setMetaData(CONTEXT_KEY,new ApplicationContextHolder(ctx));
  InjectorHolder.setInjector(new AnnotSpringInjector(new ContextLocator()));
}
