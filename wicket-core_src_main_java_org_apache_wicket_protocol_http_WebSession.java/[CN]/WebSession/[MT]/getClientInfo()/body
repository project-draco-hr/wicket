{
  if (clientInfo == null) {
    RequestCycle requestCycle=RequestCycle.get();
    if (getApplication().getRequestCycleSettings().getGatherExtendedBrowserInfo()) {
      if (getMetaData(BROWSER_WAS_POLLED_KEY) == null) {
        setMetaData(BROWSER_WAS_POLLED_KEY,Boolean.TRUE);
        Request request=requestCycle.getRequest();
        IRequestHandler activeRequestHandler=requestCycle.getActiveRequestHandler();
        final String url;
        if (activeRequestHandler != null) {
          url=requestCycle.urlFor(activeRequestHandler).toString();
        }
 else {
          url=requestCycle.urlFor(getApplication().getHomePage(),null).toString();
        }
        String relativeUrl=requestCycle.getUrlRenderer().renderContextPathRelativeUrl(url);
        Page browserInfoPage=newBrowserInfoPage(relativeUrl);
        throw new RestartResponseException(browserInfoPage);
      }
      setMetaData(BROWSER_WAS_POLLED_KEY,null);
    }
    clientInfo=new WebClientInfo(requestCycle);
  }
  return (WebClientInfo)clientInfo;
}
