{
  Key key=new Key(scope.getName(),name,locale,style,variation);
  ResourceReference res=map.get(key);
  if (strict) {
    if (res == null && createIfNotFound) {
      res=addDefaultResourceReference(scope,name,locale,style,variation);
    }
  }
  if (strict || res != null) {
    return res;
  }
 else {
    res=getResourceReference(scope,name,locale,style,null,true,false);
    if (res == null) {
      res=getResourceReference(scope,name,locale,null,variation,true,false);
    }
    if (res == null) {
      res=getResourceReference(scope,name,locale,null,null,true,false);
    }
    if (res == null) {
      res=getResourceReference(scope,name,null,style,variation,true,false);
    }
    if (res == null) {
      res=getResourceReference(scope,name,null,style,null,true,false);
    }
    if (res == null) {
      res=getResourceReference(scope,name,null,null,variation,true,false);
    }
    if (res == null) {
      res=getResourceReference(scope,name,null,null,null,true,false);
    }
    if (res == null && createIfNotFound) {
      res=addDefaultResourceReference(scope,name,locale,style,variation);
    }
    return res;
  }
}
