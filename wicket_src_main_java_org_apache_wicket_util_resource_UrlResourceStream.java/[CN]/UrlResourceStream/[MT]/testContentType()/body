{
  if (contentType == null || contentType.contains("unknown")) {
    Application application=Application.get();
    if (application instanceof WebApplication) {
      contentType=((WebApplication)application).getServletContext().getMimeType(url.getFile());
      if (contentType == null) {
        contentType=URLConnection.getFileNameMap().getContentTypeFor(url.getFile());
      }
    }
 else {
      contentType=URLConnection.getFileNameMap().getContentTypeFor(url.getFile());
    }
  }
}
