{
  IRequestCodingStrategy requestCodingStrategy=requestCycle.getProcessor().getRequestCodingStrategy();
  IRequestTarget mounted=requestCodingStrategy.targetForRequest(requestParameters);
  if (mounted != null) {
    if (mounted instanceof IBookmarkablePageRequestTarget) {
      IBookmarkablePageRequestTarget bookmarkableTarget=(IBookmarkablePageRequestTarget)mounted;
      if (requestParameters.getComponentPath() != null && requestParameters.getInterfaceName() != null) {
        final String componentPath=requestParameters.getComponentPath();
        final Page<?> page=Session.get().getPage(requestParameters.getPageMapName(),componentPath,requestParameters.getVersionNumber());
        if (page != null && page.getClass() == bookmarkableTarget.getPageClass()) {
          return resolveListenerInterfaceTarget(requestCycle,page,componentPath,requestParameters.getInterfaceName(),requestParameters);
        }
 else {
          PageParameters params=new PageParameters(requestParameters.getParameters());
          return new BookmarkableListenerInterfaceRequestTarget(requestParameters.getPageMapName(),bookmarkableTarget.getPageClass(),params,requestParameters.getComponentPath(),requestParameters.getInterfaceName());
        }
      }
    }
    return mounted;
  }
  IRequestTarget target=null;
  final String path=requestParameters.getPath();
  if (requestParameters.getBookmarkablePageClass() != null) {
    target=resolveBookmarkablePage(requestCycle,requestParameters);
  }
 else   if (requestParameters.getComponentPath() != null) {
    target=resolveRenderedPage(requestCycle,requestParameters);
  }
 else   if (requestParameters.getResourceKey() != null) {
    target=resolveSharedResource(requestCycle,requestParameters);
  }
 else   if (Strings.isEmpty(path) || ("/".equals(path))) {
    target=resolveHomePageTarget(requestCycle,requestParameters);
  }
  if (target != null) {
    if (Application.get().getSecuritySettings().getEnforceMounts() && requestCodingStrategy.pathForTarget(target) != null) {
      String msg="Direct access not allowed for mounted targets";
      log.error(msg + " [request=" + requestCycle.getRequest()+ ",target="+ target+ ",session="+ Session.get()+ "]");
      throw new AbortWithWebErrorCodeException(HttpServletResponse.SC_FORBIDDEN,msg);
    }
    return target;
  }
 else {
    return resolveExternalResource(requestCycle);
  }
}
