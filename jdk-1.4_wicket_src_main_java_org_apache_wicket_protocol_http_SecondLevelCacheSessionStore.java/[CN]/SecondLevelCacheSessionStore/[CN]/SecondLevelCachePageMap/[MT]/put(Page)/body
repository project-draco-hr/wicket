{
  if (!page.isPageStateless()) {
    String sessionId=getSession().getId();
    if (sessionId != null) {
      getStore().storePage(sessionId,page);
      lastPage=page;
      dirty();
      PageVersions pv=new PageVersions(page.getNumericId(),page.getCurrentVersionNumber(),page.getAjaxVersionNumber());
      pageVersions.remove(pv);
      pageVersions.add(pv);
      if (pageVersions.size() > 100) {
        pageVersions.remove(0);
      }
    }
  }
}
