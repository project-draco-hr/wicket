{
  Component linkComponent=getComponentFromLastRenderedPage(path);
  if (linkComponent instanceof AjaxLink) {
    if (isAjax == false) {
      Assert.fail("Link " + path + "is an AjaxLink and will "+ "not be invoked when AJAX (javascript) is disabled.");
    }
    AjaxLink link=(AjaxLink)linkComponent;
    setupRequestAndResponse();
    RequestCycle requestCycle=createRequestCycle();
    AjaxRequestTarget target=new AjaxRequestTarget();
    requestCycle.setRequestTarget(target);
    link.onClick(target);
    target.respond(requestCycle);
  }
 else   if (linkComponent instanceof AjaxFallbackLink && isAjax) {
    AjaxFallbackLink link=(AjaxFallbackLink)linkComponent;
    setupRequestAndResponse();
    RequestCycle requestCycle=createRequestCycle();
    AjaxRequestTarget target=new AjaxRequestTarget();
    requestCycle.setRequestTarget(target);
    link.onClick(target);
    target.respond(requestCycle);
  }
 else   if (linkComponent instanceof AjaxSubmitLink) {
    if (isAjax == false) {
      Assert.fail("Link " + path + "is an AjaxSubmitLink and "+ "will not be invoked when AJAX (javascript) is disabled.");
    }
    AjaxSubmitLink link=(AjaxSubmitLink)linkComponent;
    List behaviors=link.getBehaviors();
    AjaxFormSubmitBehavior ajaxFormSubmitBehavior=null;
    for (Iterator iter=behaviors.iterator(); iter.hasNext(); ) {
      Object behavior=iter.next();
      if (behavior instanceof AjaxFormSubmitBehavior) {
        AjaxFormSubmitBehavior submitBehavior=(AjaxFormSubmitBehavior)behavior;
        ajaxFormSubmitBehavior=submitBehavior;
      }
    }
    String failMessage="No form submit behavior found on the submit link. Strange!!";
    Assert.assertNotNull(failMessage,ajaxFormSubmitBehavior);
    setupRequestAndResponse();
    RequestCycle requestCycle=createRequestCycle();
    submitAjaxFormSubmitBehavior(ajaxFormSubmitBehavior);
    ajaxFormSubmitBehavior.onRequest();
    requestCycle.getRequestTarget().respond(requestCycle);
  }
 else   if (linkComponent instanceof Link) {
    Link link=(Link)linkComponent;
    if (link instanceof BookmarkablePageLink) {
      BookmarkablePageLink bookmarkablePageLink=(BookmarkablePageLink)link;
      try {
        Field parametersField=BookmarkablePageLink.class.getDeclaredField("parameters");
        parametersField.setAccessible(true);
        PageParameters parameters=(PageParameters)parametersField.get(bookmarkablePageLink);
        setParametersForNextRequest(parameters);
      }
 catch (      Exception e) {
        Assert.fail("Internal error in WicketTester. " + "Please report this in Wickets Issue Tracker.");
      }
    }
    executeListener(link);
  }
 else {
    Assert.fail("Link " + path + " is not a Link, AjaxLink, AjaxFallbackLink or AjaxSubmitLink");
  }
}
