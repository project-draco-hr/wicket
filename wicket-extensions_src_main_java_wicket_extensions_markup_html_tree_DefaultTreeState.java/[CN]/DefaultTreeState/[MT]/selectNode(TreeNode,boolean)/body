{
  if (selected == true && selectedNodes.contains(node) == false) {
    if (isAllowSelectMultiple() == false && selectedNodes.size() > 0) {
      for (Iterator i=selectedNodes.iterator(); i.hasNext(); ) {
        TreeNode current=(TreeNode)i.next();
        i.remove();
        Object[] listenersCopy=listeners.toArray();
        for (int j=0; j < listenersCopy.length; j++) {
          ITreeStateListener l=(ITreeStateListener)listenersCopy[j];
          l.nodeUnselected(current);
        }
      }
    }
    selectedNodes.add(node);
    Object[] listenersCopy=listeners.toArray();
    for (int i=0; i < listenersCopy.length; i++) {
      ITreeStateListener l=(ITreeStateListener)listenersCopy[i];
      l.nodeSelected(node);
    }
  }
 else   if (selected == false && selectedNodes.contains(node) == true) {
    selectedNodes.remove(node);
    Object[] listenersCopy=listeners.toArray();
    for (int i=0; i < listenersCopy.length; i++) {
      ITreeStateListener l=(ITreeStateListener)listenersCopy[i];
      l.nodeUnselected(node);
    }
  }
}
