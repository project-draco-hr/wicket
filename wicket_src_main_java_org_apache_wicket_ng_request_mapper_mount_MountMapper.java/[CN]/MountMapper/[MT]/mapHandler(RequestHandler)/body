{
  Mount mount=mapper.mapHandler(handler);
  if (mount == null) {
    return null;
  }
  for (int i=mountSegments.length; i > 0; i--) {
    String segment=mountSegments[i - 1];
    String placeholder=getPlaceholder(segment);
    String replacement=segment;
    if (placeholder != null) {
      replacement=mount.getMountParameters().getValue(placeholder).toString();
      if (replacement == null) {
        throw new IllegalStateException();
      }
    }
    mount.getUrl().getSegments().add(0,replacement);
  }
  return mount.getUrl();
}
