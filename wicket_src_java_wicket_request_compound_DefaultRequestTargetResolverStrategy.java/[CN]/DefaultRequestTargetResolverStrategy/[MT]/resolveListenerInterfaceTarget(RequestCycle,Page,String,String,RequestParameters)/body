{
  if (interfaceName.equals("IRedirectListener")) {
    return new RedirectPageRequestTarget(page);
  }
 else {
    Method listenerMethod=requestCycle.getRequestInterfaceMethod(interfaceName);
    if (listenerMethod == null) {
      throw new WicketRuntimeException("Attempt to access unknown interface " + interfaceName);
    }
    String componentPart=Strings.afterFirstPathComponent(componentPath,Component.PATH_SEPARATOR);
    if (Strings.isEmpty(componentPart)) {
      throw new WicketRuntimeException("when trying to call " + listenerMethod + ", a component must be provided");
    }
    Component component=page.get(componentPart);
    if (component == null) {
      throw new WicketRuntimeException("Calling listener methods on non-existing component: " + componentPath);
    }
    if (!component.isVisible()) {
      throw new WicketRuntimeException("Calling listener methods on components that are not visible is not allowed: " + componentPath);
    }
    if (interfaceName.equals("IResourceListener")) {
      return new ComponentResourceRequestTarget(page,component,listenerMethod);
    }
 else     if (interfaceName.equals("IBehaviorListener")) {
      return new BehaviorRequestTarget(page,component,listenerMethod,requestParameters);
    }
    return new ListenerInterfaceRequestTarget(page,component,listenerMethod,requestParameters);
  }
}
