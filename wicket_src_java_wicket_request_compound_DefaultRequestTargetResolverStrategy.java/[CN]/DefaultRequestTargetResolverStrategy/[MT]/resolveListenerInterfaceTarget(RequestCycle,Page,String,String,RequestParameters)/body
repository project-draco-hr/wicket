{
  if (interfaceName.equals(IRedirectListener.INTERFACE.getName())) {
    return new RedirectPageRequestTarget(page);
  }
 else {
    final RequestListenerInterface listener=RequestListenerInterface.forName(interfaceName);
    if (listener == null) {
      throw new WicketRuntimeException("Attempt to access unknown request listener interface " + interfaceName);
    }
    final String pageRelativeComponentPath=Strings.afterFirstPathComponent(componentPath,Component.PATH_SEPARATOR);
    if (Strings.isEmpty(pageRelativeComponentPath)) {
      throw new WicketRuntimeException("When trying to call " + listener + ", a component must be provided");
    }
    final Component component=page.get(pageRelativeComponentPath);
    if (component == null) {
      throw new WicketRuntimeException("Attempt to call listener method on non-existant component: " + componentPath);
    }
    if (!component.isVisibleInHierarchy()) {
      throw new WicketRuntimeException("Calling listener methods on components that are not visible is not allowed: " + componentPath);
    }
    return listener.newRequestTarget(page,component,listener,requestParameters);
  }
}
