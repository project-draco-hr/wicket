{
  if (this.markupProvider == null) {
    MarkupContainer parent=getParent();
    while ((parent != null) && !(parent instanceof IMarkupProvider)) {
      parent=parent.getParent();
    }
    if (parent == null) {
      throw new WicketRuntimeException("Component has no parent with external markup file: " + getId());
    }
    MarkupFragment fragment=((IMarkupProvider)parent).getMarkupFragment(this.markupId);
    if (fragment == null) {
      throw new WicketRuntimeException("Unable to find the markup fragment with markup path '" + path + "'. Component: "+ getId());
    }
    return fragment;
  }
  MarkupFragment fragment=((IMarkupProvider)this.markupProvider).getMarkupFragment(this.markupId);
  if (fragment == null) {
    throw new WicketRuntimeException("Unable to find the markup fragment with markup path '" + path + "' in markup provided by container: "+ this.markupProvider.getId()+ ". Component: "+ getId());
  }
  return fragment;
}
