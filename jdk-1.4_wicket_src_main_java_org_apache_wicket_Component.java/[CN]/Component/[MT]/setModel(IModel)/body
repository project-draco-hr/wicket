{
  IModel prevModel=getModelImpl();
  if (prevModel != null) {
    prevModel.detach();
  }
  if (prevModel instanceof IWrapModel) {
    prevModel=((IWrapModel)prevModel).getWrappedModel();
  }
  if (prevModel != model) {
    if (prevModel != null) {
      addStateChange(new ComponentModelChange(prevModel));
    }
    setModelImpl(wrap(model));
  }
  modelChanged();
  return this;
}
