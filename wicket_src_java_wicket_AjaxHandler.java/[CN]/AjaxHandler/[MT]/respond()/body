{
  try {
    final RequestCycle cycle=RequestCycle.get();
    cycle.setRequestTarget(new EmptyRequestTarget());
    resourceStream=getResponse();
    if (resourceStream == null) {
      throw new WicketRuntimeException("Could not get resource stream");
    }
    final Response response=cycle.getResponse();
    configure(response,resourceStream);
    respond(response);
  }
  finally {
    resourceStream=null;
  }
}
