{
  boolean authorized=true;
  final Package componentPackage=componentClass.getPackage();
  if (componentPackage != null) {
    final AuthorizeInstantiation packageAnnotation=componentPackage.getAnnotation(AuthorizeInstantiation.class);
    if (packageAnnotation != null) {
      authorized=hasAny(new Roles(packageAnnotation.value()));
    }
  }
  final AuthorizeInstantiation classAnnotation=(AuthorizeInstantiation)componentClass.getAnnotation(AuthorizeInstantiation.class);
  if (classAnnotation != null) {
    authorized=hasAny(new Roles(classAnnotation.value()));
  }
  return authorized;
}
