{
  AppendingStringBuffer buffer=new AppendingStringBuffer();
  if (isCustomComponent() == true) {
    buffer.append("var element = document.getElementById(\"" + getContentMarkupId() + "\");\n");
  }
  buffer.append("var settings = new Object();\n");
  buffer.append("settings.minWidth=" + getMinimalWidth() + ";\n");
  buffer.append("settings.minHeight=" + getMinimalHeight() + ";\n");
  buffer.append("settings.className=\"" + getCssClassName() + "\";\n");
  buffer.append("settings.width=\"" + getInitialWidth() + "\";\n");
  if (isUseInitialHeight() == true || isCustomComponent() == false)   buffer.append("settings.height=\"" + getInitialHeight() + "\";\n");
 else   buffer.append("settings.height=null;\n");
  buffer.append("settings.resizable=" + Boolean.toString(isResizable()) + ";\n");
  if (isResizable() == false) {
    buffer.append("settings.widthUnit=\"" + getWidthUnit() + "\";\n");
    buffer.append("settings.heightUnit=\"" + getHeightUnit() + "\";\n");
  }
  if (isCustomComponent() == false) {
    Page page=createPage();
    if (page == null) {
      throw new WicketRuntimeException("Error creating page for modal dialog.");
    }
    buffer.append("settings.src=\"" + RequestCycle.get().urlFor(page) + "\";\n");
    if (getPageMapName() != null) {
      buffer.append("settings.iframeName=\"" + getPageMapName() + "\";\n");
    }
  }
 else {
    buffer.append("settings.element = element;\n");
  }
  if (getCookieName() != null) {
    buffer.append("settings.cookieId=\"" + getCookieName() + "\";\n");
  }
  Object title=getTitle() != null ? getTitle().getObject() : null;
  if (title != null) {
    buffer.append("settings.title=\"" + escapeQuotes(title.toString()) + "\";\n");
  }
  if (getMaskType() == MaskType.TRANSPARENT) {
    buffer.append("settings.mask=\"transparent\";\n");
  }
 else   if (getMaskType() == MaskType.SEMI_TRANSPARENT) {
    buffer.append("settings.mask=\"semi-transparent\";\n");
  }
  boolean haveCloseCallback=false;
  if ((isCustomComponent() == false && deletePageMap) || windowClosedCallback != null) {
    WindowClosedBehavior behavior=(WindowClosedBehavior)getBehaviors(WindowClosedBehavior.class).get(0);
    buffer.append("settings.onClose = function() { " + behavior.getCallbackScript() + " };\n");
    haveCloseCallback=true;
  }
  if (closeButtonCallback != null || haveCloseCallback == false) {
    CloseButtonBehavior behavior=(CloseButtonBehavior)getBehaviors(CloseButtonBehavior.class).get(0);
    buffer.append("settings.onCloseButton = function() { " + behavior.getCallbackScript() + "};\n");
  }
  postProcessSettings(buffer);
  buffer.append("Wicket.Window.create(settings).show();\n");
  return buffer.toString();
}
