{
  Application.set(this);
  context=new MockServletContext(this,path);
  final PortletContext portletContext=new MockPortletContext(context);
  setWicketPortlet(new WicketPortlet(){
    private static final long serialVersionUID=1L;
    @Override public PortletContext getPortletContext(){
      return portletContext;
    }
    @Override public String getPortletName(){
      return "MockPortlet";
    }
    @Override public String getInitParameter(    String key){
      return null;
    }
  }
);
  this.internalInit();
  this.init();
  this.initializeComponents();
  servletSession=new MockHttpSession(context);
  portletSession=new MockPortletSession(servletSession);
  getApplicationSettings().setContextPath(context.getServletContextName());
  getResourceSettings().setResourceFinder(new WebApplicationPath(context));
  getPageSettings().setAutomaticMultiWindowSupport(false);
}
