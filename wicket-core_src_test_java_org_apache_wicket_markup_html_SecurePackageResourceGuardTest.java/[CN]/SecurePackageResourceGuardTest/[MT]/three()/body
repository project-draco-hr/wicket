{
  SecurePackageResourceGuard guard=new SecurePackageResourceGuard();
  guard.getPattern().clear();
  guard.addPattern("+mydir**/*X/*.gif");
  assertFalse(guard.acceptAbsolutePath("test.gif"));
  assertFalse(guard.acceptAbsolutePath("mydir/test.gif"));
  assertFalse(guard.acceptAbsolutePath("mydir/dir2/xxx.gif"));
  assertTrue(guard.acceptAbsolutePath("mydirAA/dir2X/xxx.gif"));
  assertFalse(guard.acceptAbsolutePath("mydirAA/dir2/xxx.gif"));
  assertTrue(guard.acceptAbsolutePath("mydir/dir2X/xxx.gif"));
  assertFalse(guard.acceptAbsolutePath("mydir/dir2/dir3/xxx.gif"));
  assertFalse(guard.acceptAbsolutePath("/mydir/test.gif"));
}
