{
  add(new AjaxLink("link"){
    private static final long serialVersionUID=1L;
    @Override public void onClick(    AjaxRequestTarget target){
      clicked=true;
      target.addComponent(this);
    }
    @Override protected void onAfterRender(){
      super.onAfterRender();
      if (clicked) {
        throw new IllegalStateException("Intentional error");
      }
    }
  }
);
}
