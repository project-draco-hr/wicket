{
  this.markupFragments=new MarkupFragment(this);
  MarkupFragment current=this.markupFragments;
  for (  MarkupElement elem : this.markup) {
    if (elem instanceof RawMarkup) {
      current.addMarkupElement(elem);
    }
 else {
      final ComponentTag tag=(ComponentTag)elem;
      if (tag.isOpen()) {
        if (tag.hasNoCloseTag()) {
          new MarkupFragment(this,current,tag);
        }
 else {
          current=new MarkupFragment(this,current,tag);
        }
      }
 else       if (tag.isOpenClose()) {
        new MarkupFragment(this,current,tag);
      }
 else {
        current.addMarkupElement(tag);
        current=current.getParentFragment();
      }
    }
  }
}
