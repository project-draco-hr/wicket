{
  this.componentMap=null;
  if (markup != null) {
    for (int i=0; i < this.markup.size(); i++) {
      MarkupElement elem=(MarkupElement)this.markup.get(i);
      if (elem instanceof WicketTag) {
        WicketTag tag=(WicketTag)elem;
        if (tag.isOpen() && tag.isHeadTag() && (tag.getWicketHeaderClass() == null)) {
          tag.setWicketHeaderClass(getResource().getMarkupClass());
        }
      }
    }
    StringBuffer componentPath=null;
    for (int i=0; i < this.markup.size(); i++) {
      MarkupElement elem=(MarkupElement)this.markup.get(i);
      if (elem instanceof ComponentTag) {
        ComponentTag tag=(ComponentTag)elem;
        componentPath=setComponentPathForTag(componentPath,tag);
        addToCache(i,tag);
      }
    }
  }
  this.currentPath=null;
}
