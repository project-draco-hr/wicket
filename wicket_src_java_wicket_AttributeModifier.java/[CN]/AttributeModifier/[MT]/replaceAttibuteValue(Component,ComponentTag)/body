{
  if (enabled) {
    final ValueMap attributes=tag.getAttributes();
    final Object replacementValue=replaceModel.getObject(component);
    if (replacementValue != null) {
      if (attributes.containsKey(attribute)) {
        final String value=attributes.get(attribute).toString();
        if (pattern == null || value.matches(pattern)) {
          attributes.put(attribute,newValue(value,replacementValue.toString()));
        }
      }
 else       if (addAttributeIfNotPresent) {
        attributes.put(attribute,newValue(null,replacementValue.toString()));
      }
    }
  }
}
