{
  if (enabled) {
    final ValueMap attributes=tag.getAttributes();
    final Object replacementValue=getReplaceModel().getObject();
    if (replacementValue != null) {
      if (attributes.containsKey(attribute)) {
        final String value=attributes.get(attribute).toString();
        if (pattern == null || value.matches(pattern)) {
          attributes.put(attribute,replacementValue);
        }
      }
 else       if (addAttributeIfNotPresent) {
        attributes.put(attribute,replacementValue);
      }
    }
  }
}
