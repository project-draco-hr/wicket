{
  if (children != null) {
    addStateChange(new Change(){
      private static final long serialVersionUID=1L;
      final Object removedChildren=MarkupContainer.this.children;
      @Override public void undo(){
        MarkupContainer.this.children=removedChildren;
        int size=children_size();
        for (int i=0; i < size; i++) {
          final Component child=children_get(i);
          child.setParent(MarkupContainer.this);
        }
      }
      @Override public String toString(){
        return "RemoveAllChange[component: " + getPath() + ", removed Children: "+ removedChildren+ "]";
      }
    }
);
    int size=children_size();
    for (int i=0; i < size; i++) {
      final Component child=children_get(i);
      child.detachModel();
      child.setParent(null);
    }
    this.children=null;
  }
}
