{
  final MarkupElement element=markupStream.get();
  if ((element instanceof ComponentTag) && !markupStream.atCloseTag()) {
    final ComponentTag tag=(ComponentTag)element;
    final String id=tag.getId();
    final Component component=get(id);
    if (component != null) {
      component.render();
    }
 else {
      final List componentResolvers=this.getApplication().getComponentResolvers();
      final Iterator iterator=componentResolvers.iterator();
      while (iterator.hasNext()) {
        final IComponentResolver resolver=(IComponentResolver)iterator.next();
        if (resolver.resolve(this,markupStream,tag)) {
          return;
        }
      }
      MarkupContainer container=this;
      while (container != null) {
        if (container instanceof IComponentResolver) {
          if (((IComponentResolver)container).resolve(this,markupStream,tag)) {
            return;
          }
        }
        container=container.findParent(MarkupContainer.class);
      }
      if ("child".equals(tag.getName()) && (tag.getNamespace() != null)) {
        markupStream.throwMarkupException("Classes of base pages which " + "require inherited markup may not be used directly. " + "You must instantiate the child pages instead: "+ this);
      }
      markupStream.throwMarkupException("Unable to find component with id '" + id + "' in "+ this+ ". This means that you declared wicket:id="+ id+ " in your markup, but that you either did not add the "+ "component to your page at all, or that the hierarchy does not match.");
    }
  }
 else {
    if (log.isDebugEnabled()) {
      log.debug("Rendering raw markup");
    }
    getResponse().write(element.toString());
    markupStream.next();
  }
}
