{
  if (pageMapName != null && getPopupSettings() != null) {
    throw new IllegalStateException("You cannot specify popup settings and a page map");
  }
  PageParameters parameters=getPageParameters();
  if (getPopupSettings() != null) {
    return urlFor(getPopupSettings().getPageMap(this),getPageClass(),parameters);
  }
 else {
    return urlFor(getPageMap(),getPageClass(),parameters);
  }
}
