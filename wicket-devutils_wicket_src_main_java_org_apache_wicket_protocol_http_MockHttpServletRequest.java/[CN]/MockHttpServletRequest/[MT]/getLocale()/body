{
  final String header=getHeader("Accept-Language");
  if (header == null) {
    return Locale.getDefault();
  }
  final String[] firstLocale=header.split(",");
  if (firstLocale.length < 1) {
    return Locale.getDefault();
  }
  final String[] bits=firstLocale[0].split("-");
  if (bits.length < 1) {
    return Locale.getDefault();
  }
  final String language=bits[0].toLowerCase();
  if (bits.length > 1) {
    final String country=bits[1].toUpperCase();
    return new Locale(language,country);
  }
 else {
    return new Locale(language);
  }
}
