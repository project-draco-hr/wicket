{
  WicketTester tester=new WicketTester();
  final Page page=new MockPageWithLink();
  AjaxLink ajaxLink=new AjaxLink(page,MockPageWithLink.LINK_ID){
    private static final long serialVersionUID=1L;
    @Override public void onClick(    AjaxRequestTarget target){
      Link link=new Link(page,MockPageWithLink.LINK_ID){
        private static final long serialVersionUID=1L;
        @Override public void onClick(){
        }
      }
;
      link.setOutputMarkupId(true);
      target.addComponent(link);
    }
  }
;
  ajaxLink.setOutputMarkupId(true);
  tester.startPage(new ITestPageSource(){
    private static final long serialVersionUID=1L;
    public Page getTestPage(){
      return page;
    }
  }
);
  tester.clickLink(MockPageWithLink.LINK_ID);
  tester.assertComponent(MockPageWithLink.LINK_ID,Link.class);
  Component component=tester.getComponentFromLastRenderedPage(MockPageWithLink.LINK_ID);
  tester.assertComponentOnAjaxResponse(component);
}
