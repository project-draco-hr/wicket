{
  IRequestCycle requestCycle=RequestCycle.get();
  WebRequest webRequest=(WebRequest)requestCycle.getRequest();
  HttpServletRequest request=((ServletWebRequest)webRequest).getHttpServletRequest();
  if (protocol == null || protocol == Protocol.PRESERVE_CURRENT || request.getScheme().equals(protocol.toString().toLowerCase())) {
    return null;
  }
 else {
    return new SwitchProtocolRequestHandler(protocol,handler,httpsConfig);
  }
}
