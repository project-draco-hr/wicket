{
  IMarkupFilter parent=this.markupFilterChain;
  IMarkupFilter prevParent=null;
  while (parent.getPriority() > filter.getPriority()) {
    prevParent=parent;
    parent=parent.getParent();
    if (parent == null) {
      throw new WicketRuntimeException("The filters priority is too low. Must be > 0. Filter: " + filter);
    }
  }
  filter.setParent(parent);
  if (parent == this.markupFilterChain) {
    this.markupFilterChain=filter;
  }
 else {
    prevParent.setParent(filter);
  }
}
