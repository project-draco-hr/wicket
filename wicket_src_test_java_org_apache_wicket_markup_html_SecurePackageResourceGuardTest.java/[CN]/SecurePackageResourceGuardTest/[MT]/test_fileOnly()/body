{
  SecurePackageResourceGuard guard=new SecurePackageResourceGuard();
  guard.addPattern("+**.gif");
  guard.addPattern("+*.gif*");
  guard.addPattern("+*.gi*");
  guard.addPattern("+test*.gif");
  assertTrue(guard.acceptAbsolutePath("test.gif"));
  assertTrue(guard.acceptAbsolutePath("mydir/test.gif"));
  assertTrue(guard.acceptAbsolutePath("/root/mydir/test.gif"));
  assertFalse(guard.acceptAbsolutePath("../test.gif"));
  assertTrue(guard.acceptAbsolutePath("test.giX"));
  assertTrue(guard.acceptAbsolutePath("mydir/test.gifABCD"));
  assertTrue(guard.acceptAbsolutePath("mydir/testXXX.gif"));
  guard.addPattern("-**/testA.gif");
  assertFalse(guard.acceptAbsolutePath("mydir/testA.gif"));
}
