{
  String componentName=tag.getNameAttribute();
  if (componentName == null) {
    componentName="anonymous-" + autoIndex;
    autoIndex++;
  }
  final String classname=tag.getAttributes().getString("class");
  final Class clazz=RequestCycle.get().getApplication().getSettings().getDefaultPageFactory().classForName(classname);
  final Component component;
  try {
    final Constructor constructor=clazz.getConstructor(new Class[]{String.class});
    component=(Component)constructor.newInstance(new Object[]{componentName});
  }
 catch (  NoSuchMethodException ex) {
    throw new RenderException("Unable to create Component derived from wicket tag",ex);
  }
catch (  InvocationTargetException ex) {
    throw new RenderException("Unable to create Component derived from wicket tag",ex);
  }
catch (  IllegalAccessException ex) {
    throw new RenderException("Unable to create Component derived from wicket tag",ex);
  }
catch (  InstantiationException ex) {
    throw new RenderException("Unable to create Component derived from wicket tag",ex);
  }
catch (  ClassCastException ex) {
    throw new RenderException("Unable to create Component derived from wicket tag",ex);
  }
  final Iterator iter=tag.getAttributes().entrySet().iterator();
  while (iter.hasNext()) {
    final Map.Entry entry=(Map.Entry)iter.next();
    final String key=(String)entry.getKey();
    final String value=(String)entry.getKey();
    if ("name".equalsIgnoreCase(key) || ("class".equalsIgnoreCase(key))) {
      continue;
    }
    final String methodName="set" + key;
    final Method[] methods=component.getClass().getMethods();
    Method method=null;
    for (int i=0; i < methods.length; i++) {
      if (methods[i].getName().equalsIgnoreCase(methodName)) {
        method=methods[i];
      }
    }
    if (method == null) {
      throw new RenderException("Unable to initialize Component. Method with name " + methodName + " not found");
    }
    final Class[] parameterClasses=method.getParameterTypes();
    if (parameterClasses.length != 1) {
      throw new RenderException("Unable to initialize Component. Method with name " + methodName + " must have one and only one parameter");
    }
    final Class paramClass=parameterClasses[0];
    try {
      if (paramClass.equals(String.class)) {
        method.invoke(component,new Object[]{value});
      }
 else       if (paramClass.equals(int.class)) {
        method.invoke(component,new Object[]{new Integer(tag.getAttributes().getInt(key))});
      }
 else       if (paramClass.equals(long.class)) {
        method.invoke(component,new Object[]{new Long(tag.getAttributes().getLong((key)))});
      }
    }
 catch (    IllegalAccessException ex) {
      throw new RenderException("Unable to initialize Component. Failure while invoking method " + methodName,ex);
    }
catch (    InvocationTargetException ex) {
      throw new RenderException("Unable to initialize Component. Failure while invoking method " + methodName,ex);
    }
catch (    StringValueConversionException ex) {
      throw new RenderException("Unable to initialize Component. Failure while invoking method " + methodName,ex);
    }
  }
  return component;
}
