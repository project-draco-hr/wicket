{
  bodyResponse.write("<?xml version=\"1.0\" encoding=\"");
  bodyResponse.write(encoding);
  bodyResponse.write("\"?>");
  bodyResponse.write("<ajax-response>");
  respondersFrozen=true;
  fireOnBeforeRespondListeners();
  Iterator<CharSequence> it=prependJavaScripts.iterator();
  while (it.hasNext()) {
    CharSequence js=it.next();
    respondInvocation(bodyResponse,js);
  }
  componentsFrozen=true;
  respondComponents(bodyResponse);
  fireOnAfterRespondListeners(bodyResponse);
  it=domReadyJavaScripts.iterator();
  while (it.hasNext()) {
    CharSequence js=it.next();
    respondInvocation(bodyResponse,js);
  }
  it=appendJavaScripts.iterator();
  while (it.hasNext()) {
    CharSequence js=it.next();
    respondInvocation(bodyResponse,js);
  }
  bodyResponse.write("</ajax-response>");
}
