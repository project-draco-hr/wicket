{
  final String appFactoryClassName=getInitParameter(APP_FACT_PARAM);
  if (appFactoryClassName == null) {
    return new ContextParamWebApplicationFactory();
  }
 else {
    try {
      final Class factoryClass=getClass().getClassLoader().loadClass(appFactoryClassName);
      return (IWebApplicationFactory)factoryClass.newInstance();
    }
 catch (    ClassCastException e) {
      throw new WicketRuntimeException("Application factory class " + appFactoryClassName + " must implement IWebApplicationFactory");
    }
catch (    ClassNotFoundException e) {
      throw new ApplicationFactoryCreationException(appFactoryClassName,e);
    }
catch (    InstantiationException e) {
      throw new ApplicationFactoryCreationException(appFactoryClassName,e);
    }
catch (    IllegalAccessException e) {
      throw new ApplicationFactoryCreationException(appFactoryClassName,e);
    }
catch (    SecurityException e) {
      throw new ApplicationFactoryCreationException(appFactoryClassName,e);
    }
  }
}
