{
  final byte[] plainBytes;
  try {
    plainBytes=new BASE64Decoder().decodeBuffer(encrypted);
    return crypt(plainBytes,Cipher.DECRYPT_MODE);
  }
 catch (  IOException e) {
    throw new WicketRuntimeException(e.getMessage());
  }
catch (  GeneralSecurityException e) {
    log.error("Unable to decrypt text '" + encrypted + "'",e);
    return null;
  }
}
