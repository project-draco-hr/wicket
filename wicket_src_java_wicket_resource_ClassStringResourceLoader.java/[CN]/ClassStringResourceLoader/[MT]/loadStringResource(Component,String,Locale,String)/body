{
  final String id=createCacheId(clazz,style,locale);
  ValueMap strings=getResourceCache(id);
  if (strings == null) {
    strings=loadResources(clazz,style,locale,id);
  }
  if (log.isDebugEnabled()) {
    log.debug("Try to load resource from: " + id + "; key: "+ key);
  }
  String value=null;
  while ((value == null) && (key != null) && (key.length() != 0)) {
    value=strings.getString(key);
    if (value != null) {
      if (log.isDebugEnabled()) {
        log.debug("Found resource from: " + id + "; key: "+ key);
      }
      break;
    }
    key=Strings.afterFirst(key,'.');
  }
  return value;
}
