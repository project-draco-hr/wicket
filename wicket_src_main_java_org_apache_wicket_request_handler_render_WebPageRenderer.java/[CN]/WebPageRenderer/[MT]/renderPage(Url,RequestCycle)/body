{
  IRequestHandler scheduled=requestCycle.getRequestHandlerScheduledAfterCurrent();
  final Response originalResponse=requestCycle.getResponse();
  BufferedWebResponse response=new BufferedWebResponse((WebResponse)originalResponse);
  Url originalBaseUrl=requestCycle.getUrlRenderer().setBaseUrl(targetUrl);
  try {
    requestCycle.setResponse(response);
    getPage().renderPage();
    if (scheduled == null && requestCycle.getRequestHandlerScheduledAfterCurrent() != null) {
      return null;
    }
 else {
      return response;
    }
  }
  finally {
    requestCycle.setResponse(originalResponse);
    requestCycle.getUrlRenderer().setBaseUrl(originalBaseUrl);
  }
}
