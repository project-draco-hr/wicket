{
  if (multiPart) {
    try {
      final WebRequest multipartWebRequest=((WebRequest)getRequest()).newMultipartWebRequest(this.maxSize);
      getRequestCycle().setRequest(multipartWebRequest);
    }
 catch (    WicketRuntimeException wre) {
      if (wre.getCause() == null || !(wre.getCause() instanceof FileUploadException)) {
        throw wre;
      }
      FileUploadException e=(FileUploadException)wre.getCause();
      final Map<String,Serializable> model=new HashMap<String,Serializable>();
      model.put("exception",e);
      model.put("maxSize",maxSize);
      if (e instanceof SizeLimitExceededException) {
        final String defaultValue="Upload must be less than " + maxSize;
        String msg=getString(getId() + "." + UPLOAD_TOO_LARGE_RESOURCE_KEY,Model.valueOf(model),defaultValue);
        error(msg);
        if (log.isDebugEnabled()) {
          log.error(msg,e);
        }
 else {
          log.error(msg);
        }
      }
 else {
        final String defaultValue="Upload failed: " + e.getLocalizedMessage();
        String msg=getString(getId() + "." + UPLOAD_FAILED_RESOURCE_KEY,Model.valueOf(model),defaultValue);
        error(msg);
        log.error(msg,e);
      }
      return false;
    }
  }
  return true;
}
