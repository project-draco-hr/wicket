{
  Button button=(Button)visitChildren(Button.class,new IVisitor(){
    public Object component(    final Component component){
      final Button button=(Button)component;
      if (getRequest().getParameter(button.getInputName()) != null || getRequest().getParameter(button.getInputName() + ".x") != null) {
        if (!button.isVisible()) {
          throw new WicketRuntimeException("Submit Button is not visible");
        }
        return button;
      }
      return CONTINUE_TRAVERSAL;
    }
  }
);
  if (button == null) {
    button=(Button)getPage().visitChildren(SubmitLink.class,new IVisitor(){
      public Object component(      final Component component){
        final SubmitLink button=(SubmitLink)component;
        if (button.getSubmitLinkForm() == Form.this && (getRequest().getParameter(button.getInputName()) != null || getRequest().getParameter(button.getInputName() + ".x") != null)) {
          if (!button.isVisible()) {
            throw new WicketRuntimeException("Submit Button is not visible");
          }
          return button;
        }
        return CONTINUE_TRAVERSAL;
      }
    }
);
  }
  return button;
}
