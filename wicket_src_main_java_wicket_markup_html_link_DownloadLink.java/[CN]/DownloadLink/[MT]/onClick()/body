{
  getRequestCycle().setRequestTarget(new IRequestTarget(){
    public void detach(    RequestCycle requestCycle){
    }
    public void respond(    RequestCycle requestCycle){
      WebResponse r=(WebResponse)requestCycle.getResponse();
      r.setAttachmentHeader(fileName);
      try {
        InputStream is=new FileInputStream(file);
        try {
          Streams.copy(is,r.getOutputStream());
        }
 catch (        IOException e) {
          throw new RuntimeException(e);
        }
 finally {
          try {
            is.close();
          }
 catch (          IOException e) {
            throw new RuntimeException(e);
          }
        }
      }
 catch (      FileNotFoundException e) {
        throw new RuntimeException(e);
      }
    }
  }
);
}
