{
  int startIndex=url.indexOf("x=");
  if (startIndex != -1) {
    startIndex=startIndex + 2;
    final String secureParam;
    final int endIndex=url.indexOf("&",startIndex);
    try {
      if (endIndex == -1) {
        secureParam=URLDecoder.decode(url.substring(startIndex),Application.get().getRequestCycleSettings().getResponseRequestEncoding());
      }
 else {
        secureParam=URLDecoder.decode(url.substring(startIndex,endIndex),Application.get().getRequestCycleSettings().getResponseRequestEncoding());
      }
    }
 catch (    UnsupportedEncodingException ex) {
      throw new WicketRuntimeException(ex);
    }
    final ICrypt urlCrypt=Application.get().getSecuritySettings().getCryptFactory().newCrypt();
    final String queryString=urlCrypt.decryptUrlSafe(secureParam);
    return rebuildUrl(queryString);
  }
  return url;
}
