{
synchronized (session) {
    session.setRequestCycle(this);
    try {
      handleRender();
    }
 catch (    RuntimeException e) {
      try {
        getPage().detachModels(getPage());
      }
 catch (      RuntimeException e1) {
        log.debug("Error detaching models when exception is thrown",e1);
      }
      handleRenderingException(e);
    }
 finally {
      response.close();
      session.setRequestCycle(null);
      threadDetach();
    }
  }
}
