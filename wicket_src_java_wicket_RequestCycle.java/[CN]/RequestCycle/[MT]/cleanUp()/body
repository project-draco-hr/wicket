{
  for (Iterator i=requestTargets.iterator(); i.hasNext(); ) {
    IRequestTarget t=(IRequestTarget)i.next();
    if (t != null) {
      try {
        t.cleanUp(this);
      }
 catch (      RuntimeException e) {
        log.error("there was an error cleaning up target " + t + ".",e);
      }
    }
  }
  try {
    internalOnEndRequest();
  }
 catch (  RuntimeException e) {
    log.error("Exception occurred during internalOnEndRequest",e);
  }
  try {
    onEndRequest();
  }
 catch (  RuntimeException e) {
    log.error("Exception occurred during onEndRequest",e);
  }
  threadDetach();
}
