{
synchronized (session) {
    try {
      threadAttach();
      internalOnBeginRequest();
      onBeginRequest();
      if (parseRequest()) {
        respond();
      }
    }
 catch (    RuntimeException e) {
      onRuntimeException(null,e);
    }
 finally {
      try {
        if (invokePage != null)         invokePage.internalEndRequest();
      }
 catch (      RuntimeException e) {
        log.error("Exception occurred during invokerPage.internalEndRequest",e);
      }
      try {
        internalOnEndRequest();
      }
 catch (      RuntimeException e) {
        log.error("Exception occurred during internalOnEndRequest",e);
      }
      try {
        onEndRequest();
      }
 catch (      RuntimeException e) {
        log.error("Exception occurred during onEndRequest",e);
      }
      threadDetach();
    }
  }
}
