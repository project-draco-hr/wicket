{
  try {
    ApplicationSettings settings=application.getSettings();
    if (settings.getUnexpectedExceptionDisplay() != ApplicationSettings.SHOW_NO_EXCEPTION_PAGE) {
      if (settings.getUnexpectedExceptionDisplay() == ApplicationSettings.SHOW_INTERNAL_ERROR_PAGE) {
        setPage(getPageFactory().newPage(application.getPages().getInternalErrorPage()));
      }
 else {
        setPage(new ExceptionErrorPage(e,getPage()));
      }
      redirectToPage(getPage());
    }
  }
 catch (  RuntimeException ignored) {
  }
  final Page currentPage=getPage();
  if (currentPage != null) {
    currentPage.resetMarkupStreams();
  }
  throw new ServletException("Wicket could not render page: " + Strings.toString(e),e);
}
