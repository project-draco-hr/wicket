{
  if (relativePathPrefixToContextRoot != null) {
    return relativePathPrefixToContextRoot;
  }
  String tmp=getRelativePathPrefixToWicketHandler();
  PrependingStringBuffer prepender=new PrependingStringBuffer(tmp);
  String path;
  try {
    path=URLDecoder.decode(Strings.replaceAll(getPath(),"%3A",":").toString(),"UTF-8");
  }
 catch (  UnsupportedEncodingException e) {
    throw new WicketRuntimeException(e);
  }
  if (path == null || path.length() == 0) {
    path="";
  }
  String wicketPath="";
  String servletPath;
  try {
    servletPath=URLDecoder.decode(Strings.replaceAll(getServletPath(),"%3A",":").toString(),"UTF-8");
  }
 catch (  UnsupportedEncodingException e) {
    throw new WicketRuntimeException(e);
  }
  if (servletPath.endsWith(path)) {
    int len=servletPath.length() - path.length() - 1;
    if (len < 0) {
      len=0;
    }
    wicketPath=servletPath.substring(0,len);
  }
 else {
    wicketPath=servletPath;
  }
  for (int i=0; i < wicketPath.length(); i++) {
    if (wicketPath.charAt(i) == '/') {
      prepender.prepend("../");
    }
  }
  return relativePathPrefixToContextRoot=prepender.toString();
}
