{
  String filepath=component.findParentWithAssociatedMarkup().getClass().getPackage().getName().replace('.','/') + "/" + component.getId();
  IResourceStream resourceStream=Application.get().getResourceStreamLocator().locate(getClass().getClassLoader(),filepath,component.getStyle(),component.getLocale(),XsltTransformer.extension);
  if (resourceStream == null) {
    throw new FileNotFoundException("Unable to find XSLT resource for " + component.toString());
  }
  StringBuffer input=new StringBuffer(4000);
  input.append("<wicket xmlns:wicket=\"http://wicket.sourceforge.net\">");
  int startPos=input.length();
  input.append(output);
  input.append("</wicket>");
  try {
    TransformerFactory tFactory=TransformerFactory.newInstance();
    Transformer transformer=tFactory.newTransformer(new StreamSource(resourceStream.getInputStream()));
    StringWriter writer=new StringWriter();
    transformer.transform(new StreamSource(new StringReader(input.toString())),new StreamResult(writer));
    input=writer.getBuffer();
    CharSequence xslOutput=input.subSequence(startPos,input.length() - 9);
    return xslOutput;
  }
  finally {
    resourceStream.close();
  }
}
