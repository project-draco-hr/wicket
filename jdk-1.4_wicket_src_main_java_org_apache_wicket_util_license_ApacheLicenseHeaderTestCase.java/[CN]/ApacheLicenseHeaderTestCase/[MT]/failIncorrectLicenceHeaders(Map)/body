{
  if (files.size() > 0) {
    StringBuffer failString=new StringBuffer();
    for (Iterator iter=files.entrySet().iterator(); iter.hasNext(); ) {
      Map.Entry entry=(Map.Entry)iter.next();
      ILicenseHeaderHandler licenseHeaderHandler=(ILicenseHeaderHandler)entry.getKey();
      List fileList=(List)entry.getValue();
      failString.append("\n");
      failString.append(licenseHeaderHandler.getClass().getName());
      failString.append(" failed. The following files(");
      failString.append(fileList.size());
      failString.append(") didn't have correct license header:\n");
      for (Iterator iterator=fileList.iterator(); iterator.hasNext(); ) {
        File file=(File)iterator.next();
        String filename=file.getAbsolutePath();
        String licenseType=licenseHeaderHandler.getLicenseType(file);
        if (licenseType == null) {
          failString.append("NONE");
        }
 else {
          failString.append(licenseType);
        }
        failString.append(" ").append(filename).append(LINE_ENDING);
      }
    }
    System.out.println(failString);
    fail(failString.toString());
  }
}
