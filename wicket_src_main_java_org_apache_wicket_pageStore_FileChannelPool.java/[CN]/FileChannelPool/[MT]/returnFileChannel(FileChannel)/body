{
  Integer count=channelToUseCount.get(channel);
  if (count == null || count == 0) {
    throw new IllegalArgumentException("Trying to return unused channel");
  }
  count=count - 1;
  if (count == 0) {
    channelToUseCount.remove(channel);
    if (channelsToDeleteOnReturn.contains(channel)) {
      closeAndDelete(channel);
    }
 else {
      idleChannels.addLast(channel);
    }
  }
 else {
    channelToUseCount.put(channel,count);
  }
}
