{
  final Page page=container.getPage();
  final String originalHref=tag.getAttributes().getString("href");
  final int pos=originalHref.indexOf(".html");
  String classPath=originalHref.substring(0,pos);
  PageParameters pageParameters=null;
  if ((classPath.length() + 6) < originalHref.length()) {
    final String queryString=originalHref.substring(classPath.length() + 6);
    pageParameters=new PageParameters(new ValueMap(queryString,"&"));
  }
  final String id=componentId + page.getAutoIndex();
  tag.setId(id);
  classPath=classPath.replaceAll("/",".");
  if (!classPath.startsWith(".")) {
    final String className=page.getClass().getPackage().getName() + "." + classPath;
    final Class clazz=page.getApplicationSettings().getDefaultClassResolver().resolveClass(className);
    return new BookmarkablePageLink(id,clazz,pageParameters);
  }
 else {
    final String className=classPath.substring(1);
    try {
      final Class clazz=page.getApplicationSettings().getDefaultClassResolver().resolveClass(className);
      return new BookmarkablePageLink(id,clazz,pageParameters);
    }
 catch (    WicketRuntimeException ex) {
      ;
    }
  }
  return new ExternalLink(id,originalHref);
}
