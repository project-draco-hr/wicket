{
  container.visitChildren(WicketHeadContainer.class,new IVisitor(){
    public Object component(    final Component<?> component){
      component.remove();
      return CONTINUE_TRAVERSAL;
    }
  }
);
  final Page page=container.getPage();
  final HeaderContainer headerContainer=(HeaderContainer)page.get(HtmlHeaderSectionHandler.HEADER_ID);
  fragment.visitChildren(MarkupFragment.class,new MarkupFragment.IVisitor(){
    private boolean foundBody=false;
    /** 
 * @see wicket.markup.MarkupFragment.IVisitor#visit(wicket.markup.MarkupElement,wicket.markup.MarkupFragment)
 */
    public Object visit(    final MarkupElement element,    final MarkupFragment parent){
      final MarkupFragment frag=(MarkupFragment)element;
      final ComponentTag tag=frag.getTag();
      if (tag.isWicketHeadTag()) {
        if (foundBody == true) {
          throwMarkupException(fragment,tag,"<wicket:head> must be before the <body>, <wicket:panel> ... tag");
        }
        WicketHeadContainer header=newWicketHeaderContainer(container,frag);
        header.setEnable(headerContainer.okToRender(header));
        return CONTINUE_TRAVERSAL_BUT_DONT_GO_DEEPER;
      }
 else       if (tag.isBodyTag()) {
        foundBody=true;
        if ((page instanceof WebPage) && !(container instanceof Page)) {
          addBodyModifier(BodyContainer.ONLOAD,container,tag);
          addBodyModifier(BodyContainer.ONUNLOAD,container,tag);
        }
      }
 else       if (tag.isMajorWicketComponentTag()) {
        foundBody=true;
      }
      return CONTINUE_TRAVERSAL;
    }
  }
);
}
