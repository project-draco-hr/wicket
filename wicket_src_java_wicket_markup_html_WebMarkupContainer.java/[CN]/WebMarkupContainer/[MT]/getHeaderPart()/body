{
  final MarkupStream associatedMarkupStream=getApplication().getMarkupCache().getMarkupStream(this,false);
  if (associatedMarkupStream == null) {
    return null;
  }
  int index=Markup.NO_HEADER_FOUND;
  if (associatedMarkupStream.getHeaderIndex() != Markup.NO_HEADER_FOUND) {
    index=associatedMarkupStream.getHeaderIndex();
  }
  if (index != Markup.NO_HEADER_FOUND) {
    associatedMarkupStream.setCurrentIndex(index);
    final MarkupElement element=associatedMarkupStream.get();
    if (element instanceof WicketTag) {
      final WicketTag wTag=(WicketTag)element;
      if ((wTag.isHeadTag() == true) && (wTag.getNamespace() != null)) {
        final String headerId="_" + Classes.name(this.getClass()) + "Header";
        WebMarkupContainer headerContainer=new WebMarkupContainer(headerId);
        headerContainer.setMarkupStream(associatedMarkupStream);
        headerContainer.setRenderBodyOnly(true);
        if (this.headerComponents != null) {
          for (Iterator iter=headerComponents.iterator(); iter.hasNext(); ) {
            headerContainer.add((Component)iter.next());
          }
        }
        return headerContainer;
      }
    }
  }
  if (this.headerComponents != null) {
    throw new MarkupException("You have added header components but did not specify a <wicket:head> region in your Page markup: " + this.toString());
  }
  return null;
}
