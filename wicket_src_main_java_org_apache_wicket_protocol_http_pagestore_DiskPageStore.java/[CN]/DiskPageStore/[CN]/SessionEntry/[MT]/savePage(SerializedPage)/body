{
  if (page.getData() != null) {
    PageMapEntry entry=getPageMapEntry(page.getPageMapName(),true);
    PageWindow window=entry.manager.createPageWindow(page.getPageId(),page.getVersionNumber(),page.getAjaxVersionNumber(),page.getData().length);
    pageMapEntryList.remove(entry);
    pageMapEntryList.add(entry);
    while (getTotalSize() > diskPageStore.getMaxSizePerSession() && pageMapEntryList.size() > 1) {
      removePageMapEntry((PageMapEntry)pageMapEntryList.get(0));
    }
    FileChannel channel=diskPageStore.fileChannelPool.getFileChannel(entry.fileName,true);
    try {
      channel.write(ByteBuffer.wrap(page.getData()),window.getFilePartOffset());
    }
 catch (    IOException e) {
      log.error("Error writing to a channel " + channel,e);
    }
 finally {
      diskPageStore.fileChannelPool.returnFileChannel(channel);
    }
  }
}
