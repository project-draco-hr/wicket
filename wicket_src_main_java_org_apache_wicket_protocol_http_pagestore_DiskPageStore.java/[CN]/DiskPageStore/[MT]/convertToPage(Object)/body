{
  if (page instanceof Page) {
    return (Page)page;
  }
 else   if (page instanceof SerializedPageWithSession) {
    SerializedPageWithSession serialized=(SerializedPageWithSession)page;
    if (serialized.page == null || serialized.page.get() != SerializedPageWithSession.NO_PAGE) {
      storeSerializedPages(serialized.sessionId,serialized.pages);
    }
    return getPage(serialized.sessionId,serialized.pageMapName,serialized.pageId,serialized.versionNumber,serialized.ajaxVersionNumber);
  }
 else {
    String type=page != null ? page.getClass().getName() : null;
    throw new IllegalArgumentException("Unknown object type: " + type);
  }
}
