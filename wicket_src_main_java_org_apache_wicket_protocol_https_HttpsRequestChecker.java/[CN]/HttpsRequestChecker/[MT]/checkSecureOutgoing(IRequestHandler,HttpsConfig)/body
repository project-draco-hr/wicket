{
  if (requestHandler != null && requestHandler instanceof SwitchProtocolRequestHandler) {
    return requestHandler;
  }
  Class<?> pageClass=getPageClass(requestHandler);
  if (pageClass != null) {
    IRequestHandler redirect=null;
    if (hasSecureAnnotation(pageClass)) {
      redirect=SwitchProtocolRequestHandler.requireProtocol(Protocol.HTTPS,requestHandler,httpsConfig);
    }
 else {
      redirect=SwitchProtocolRequestHandler.requireProtocol(Protocol.HTTP,requestHandler,httpsConfig);
    }
    if (redirect != null) {
      return redirect;
    }
  }
  return requestHandler;
}
