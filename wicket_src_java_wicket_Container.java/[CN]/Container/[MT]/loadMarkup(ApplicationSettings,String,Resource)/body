{
  final Class markupParserClass=settings.getMarkupParserClass();
  final IMarkupParser parser;
  try {
    parser=(IMarkupParser)markupParserClass.newInstance();
  }
 catch (  IllegalAccessException ex) {
    throw new IOException("Failed to load MarkupParser: " + ex.getMessage());
  }
catch (  InstantiationException ex) {
    throw new IOException("Failed to load MarkupParser: " + ex.getMessage());
  }
  parser.setComponentNameAttribute(settings.getComponentNameAttribute());
  parser.setWicketNamespace(settings.getWicketNamespace());
  parser.setStripComments(settings.getStripComments());
  parser.setCompressWhitespace(settings.getCompressWhitespace());
  parser.setStripWicketParamTag(settings.getStripWicketParamTag());
  parser.setAutolinking(settings.isAutomaticLinking());
  parser.setAutolinkBasePage(this.getPage());
  final Markup markup=parser.read(markupResource);
  markupCache.put(key,markup);
  return markup;
}
