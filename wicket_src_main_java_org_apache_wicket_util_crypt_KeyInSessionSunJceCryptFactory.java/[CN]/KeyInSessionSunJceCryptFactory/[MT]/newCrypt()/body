{
  RequestCycle rc=RequestCycle.get();
  HttpServletRequest request=((ServletWebRequest)rc.getRequest()).getHttpServletRequest();
  HttpSession session=request.getSession(true);
  final String keyAttr=Application.get().getApplicationKey() + "." + getClass().getName();
  String key=(String)session.getAttribute(keyAttr);
  if (key == null) {
    key=session.getId() + "." + UUID.randomUUID().toString();
    session.setAttribute(keyAttr,key);
  }
  ICrypt crypt=new SunJceCrypt();
  crypt.setKey(key);
  return crypt;
}
