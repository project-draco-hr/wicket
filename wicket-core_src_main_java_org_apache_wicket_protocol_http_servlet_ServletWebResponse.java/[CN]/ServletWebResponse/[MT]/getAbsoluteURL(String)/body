{
  if (url.startsWith("http://") || url.startsWith("https://")) {
    return url;
  }
 else   if (url.startsWith("/")) {
    return getAbsolutePrefix() + url;
  }
 else {
    HttpServletRequest httpServletRequest=webRequest.getContainerRequest();
    Charset charset=RequestUtils.getCharset(httpServletRequest);
    final Url current=webRequest.getClientUrl();
    Url append=Url.parse(url,charset);
    current.concatSegments(append.getSegments());
    Url result=new Url(current.getSegments(),append.getQueryParameters());
    String path=result.toString();
    if (Strings.isEmpty(path)) {
      path="/";
    }
    return Strings.join("/",getAbsolutePrefix(),httpServletRequest.getContextPath(),webRequest.getFilterPrefix(),path);
  }
}
