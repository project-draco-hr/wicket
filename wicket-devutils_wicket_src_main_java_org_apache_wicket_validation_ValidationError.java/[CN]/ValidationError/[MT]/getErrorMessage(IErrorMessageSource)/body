{
  String errorMessage=null;
  for (Iterator<String> iterator=keys.iterator(); iterator.hasNext(); ) {
    errorMessage=messageSource.getMessage(iterator.next());
    if (errorMessage != null) {
      break;
    }
  }
  if (errorMessage == null && message != null) {
    errorMessage=message;
  }
  if (errorMessage != null) {
    final Map<String,Object> p=(vars != null) ? vars : EMPTY_VARS;
    errorMessage=messageSource.substitute(errorMessage,p);
  }
  return errorMessage;
}
