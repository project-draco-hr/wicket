{
  final int tagTextLength=tagText.length();
  final TagNameParser tagnameParser=new TagNameParser(tagText);
  if (tagnameParser.matcher().lookingAt()) {
    final String tagName=tagnameParser.getName();
    String namespace=tagnameParser.getNamespace();
    int pos;
    final ComponentTag tag;
    if (wicketTagName.equals(namespace)) {
      tag=new ComponentWicketTag();
      tag.componentName=tagName;
    }
 else {
      tag=new ComponentTag();
    }
    tag.name=tagName;
    tag.namespace=namespace;
    pos=tagnameParser.matcher().end(0);
    if (pos == tagTextLength) {
      return tag;
    }
    final VariableAssignmentParser attributeParser=new VariableAssignmentParser(tagText);
    while (attributeParser.matcher().find(pos)) {
      String value=attributeParser.getValue();
      if (value == null) {
        value="";
      }
      pos=attributeParser.matcher().end(0);
      if (value.startsWith("\"")) {
        value=value.substring(1,value.length() - 1);
      }
      value=value.trim();
      final String key=attributeParser.getKey();
      boolean wicketId=key.equalsIgnoreCase("id") && value.startsWith(componentNameAttribute + "-");
      if (wicketId) {
        value=value.substring(componentNameAttribute.length() + 1).trim();
      }
      if (wicketId || key.equalsIgnoreCase(componentNameAttribute) || key.equalsIgnoreCase(ComponentTag.WICKET_COMPONENT_NAME_ATTRIBUTE)) {
        tag.componentName=value;
        Matcher matcher=MetaPattern.VARIABLE_NAME.matcher(value);
        if (!matcher.matches()) {
          log.warn("WILL BE ACTIVATED SOON: Invalid character in component name '" + componentNameAttribute + "-"+ value+ "'"+ " Regex: [a-z_]+ (case insensitive)");
        }
      }
      tag.attributes.put(key,StringValue.valueOf(value));
      if (pos == tagTextLength) {
        return tag;
      }
    }
    return tag;
  }
  return null;
}
