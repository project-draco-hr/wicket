{
  int startIndex=url.indexOf("?x=");
  if (startIndex != -1) {
    startIndex=startIndex + 3;
    final int endIndex=url.indexOf("&",startIndex);
    String secureParam;
    if (endIndex == -1) {
      secureParam=url.substring(startIndex);
    }
 else {
      secureParam=url.substring(startIndex,endIndex);
    }
    try {
      secureParam=URLDecoder.decode(secureParam,Application.get().getRequestCycleSettings().getResponseRequestEncoding());
    }
 catch (    UnsupportedEncodingException ex) {
      throw new WicketRuntimeException(ex);
    }
    final ICrypt urlCrypt=Application.get().getSecuritySettings().getCryptFactory().newCrypt();
    String queryString=urlCrypt.decryptUrlSafe(secureParam);
    queryString=rebuildUrl(queryString);
    return queryString;
  }
  return null;
}
