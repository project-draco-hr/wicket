{
  final IRequestTarget requestTarget;
  final Session session=webRequestCycle.getSession();
  final Application application=session.getApplication();
  try {
    Class homePage=application.getPages().getHomePage();
    ApplicationPages.HomePageRenderStrategy homePageStrategy=application.getPages().getHomePageRenderStrategy();
    if (homePageStrategy == ApplicationPages.BOOKMARK_REDIRECT) {
      requestTarget=new PageClassRequestTarget(homePage);
    }
 else {
      final PageParameters parameters=new PageParameters(webRequestCycle.getWebRequest().getParameterMap());
      Page newPage=session.getPageFactory().newPage(homePage,parameters);
      if (webRequestCycle.getResponsePage() == null) {
        if (homePageStrategy == ApplicationPages.PAGE_REDIRECT) {
          ApplicationSettings.RenderStrategy strategy=session.getApplication().getSettings().getRenderStrategy();
          boolean issueRedirect=(strategy == ApplicationSettings.REDIRECT_TO_RENDER || strategy == ApplicationSettings.REDIRECT_TO_BUFFER);
          webRequestCycle.setRedirect(issueRedirect);
        }
        requestTarget=new PageRequestTarget(newPage);
      }
 else {
        requestTarget=new PageRequestTarget(webRequestCycle.getResponsePage());
      }
    }
    webRequestCycle.setUpdateCluster(true);
    return requestTarget;
  }
 catch (  WicketRuntimeException e) {
    throw new WicketRuntimeException("Could not create home page",e);
  }
}
