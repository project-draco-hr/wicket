{
  Iterator it;
  it=markupIdToComponent.values().iterator();
  while (it.hasNext()) {
    final Component component=(Component)it.next();
    if (component instanceof IFeedback) {
      component.attach();
    }
    if (component instanceof MarkupContainer) {
      MarkupContainer container=(MarkupContainer)component;
      container.visitChildren(IFeedback.class,new IVisitor(){
        public Object component(        Component component){
          component.attach();
          return IVisitor.CONTINUE_TRAVERSAL;
        }
      }
);
    }
  }
  it=markupIdToComponent.values().iterator();
  while (it.hasNext()) {
    ((Component)it.next()).attach();
  }
  it=markupIdToComponent.entrySet().iterator();
  while (it.hasNext()) {
    final Map.Entry entry=(Entry)it.next();
    final Component component=(Component)entry.getValue();
    final String markupId=(String)entry.getKey();
    respondComponent(response,markupId,component);
  }
}
