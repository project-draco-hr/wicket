{
  Class clazz=(component != null ? component.getClass() : null);
  String id=createCacheId(clazz,locale,style,key);
  if (component != null) {
    id+=":" + component.getId();
  }
  String string=getCachedValue(id);
  if (string == null) {
    final List searchStack;
    final String path;
    if (component != null) {
      searchStack=getComponentStack(component);
      path=Strings.replaceAll(component.getPageRelativePath(),":",".");
    }
 else {
      searchStack=new ArrayList(0);
      searchStack.add(Application.get().getClass());
      path=null;
    }
    string=traverseResourceLoaders(key,path,searchStack,locale,style);
    if (string != null) {
      this.cachedValues.put(id,string);
    }
 else {
      this.cachedValues.put(id,NULL);
    }
  }
  if (string == NULL) {
    string=null;
  }
 else   if (string != null) {
    return substitutePropertyExpressions(component,string,model);
  }
  final IResourceSettings resourceSettings=application.getResourceSettings();
  if (resourceSettings.getUseDefaultOnMissingResource() && (defaultValue != null)) {
    return defaultValue;
  }
  if (resourceSettings.getThrowExceptionOnMissingResource()) {
    throw new MissingResourceException("Unable to find resource: " + key,(clazz != null ? getClass().getName() : ""),key);
  }
 else {
    return "[Warning: String resource for '" + key + "' not found]";
  }
}
