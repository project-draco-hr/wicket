{
  String string=null;
  final ApplicationSettings settings=application.getSettings();
  String id=createCacheId(component,locale,style,key);
  if (cachedValues.containsKey(id)) {
    if (log.isDebugEnabled()) {
      log.debug("Found message key in cache: " + id);
    }
    string=(String)cachedValues.get(id);
    if (string == NULL) {
      string=null;
    }
  }
 else {
    final Iterator iterator=settings.getStringResourceLoaders().iterator();
    while (iterator.hasNext()) {
      IStringResourceLoader loader=(IStringResourceLoader)iterator.next();
      string=loader.loadStringResource(component,key,locale,style);
      if (string != null) {
        break;
      }
    }
    if (string != null) {
      this.cachedValues.put(id,string);
    }
 else {
      this.cachedValues.put(id,NULL);
    }
  }
  if (string != null) {
    return substituteOgnl(component,string,model);
  }
  if (settings.getUseDefaultOnMissingResource() && (defaultValue != null)) {
    return defaultValue;
  }
  if (settings.getThrowExceptionOnMissingResource()) {
    throw new MissingResourceException("Unable to find resource: " + key,getClass().getName(),key);
  }
 else {
    return "[Warning: String resource for '" + key + "' not found]";
  }
}
