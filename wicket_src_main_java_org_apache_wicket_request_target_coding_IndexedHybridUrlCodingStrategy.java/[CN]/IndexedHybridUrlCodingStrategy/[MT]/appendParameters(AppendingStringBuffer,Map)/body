{
  int i=0;
  while (parameters.containsKey(String.valueOf(i))) {
    String value=(String)parameters.get(String.valueOf(i));
    if (!url.endsWith("/")) {
      url.append("/");
    }
    url.append(urlEncode(value)).append("/");
    i++;
  }
  String pageMap=(String)parameters.get(WebRequestCodingStrategy.PAGEMAP);
  if (pageMap != null) {
    i++;
    pageMap=WebRequestCodingStrategy.encodePageMapName(pageMap);
    if (!url.endsWith("/")) {
      url.append("/");
    }
    url.append(WebRequestCodingStrategy.PAGEMAP).append("/").append(urlEncode(pageMap)).append("/");
  }
  if (i != parameters.size()) {
    throw new WicketRuntimeException("Not all parameters were encoded. Make sure all parameter names are integers in consecutive order starting with zero. Current parameter names are: " + parameters.keySet().toString());
  }
}
