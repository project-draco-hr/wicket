{
  if (versionManager == null) {
    if (versionNumber == 0) {
      return this;
    }
 else {
      throw new IllegalStateException("No version manager available to retrieve requested versionNumber " + versionNumber);
    }
  }
 else {
    final boolean originalTrackChanges=getFlag(FLAG_TRACK_CHANGES);
    try {
      setFlag(FLAG_TRACK_CHANGES,false);
      final Page page=versionManager.getVersion(versionNumber);
      if (page != null && page.getCurrentVersionNumber() == 0) {
        page.versionManager=null;
      }
      return page;
    }
  finally {
      setFlag(FLAG_TRACK_CHANGES,originalTrackChanges);
    }
  }
}
