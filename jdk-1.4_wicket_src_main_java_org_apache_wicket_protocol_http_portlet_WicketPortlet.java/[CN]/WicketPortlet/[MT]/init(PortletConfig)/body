{
  super.init(config);
  Properties wicketPortletProperties=null;
  String contextProviderClassName=getContextProviderClassNameParameter(config);
  if (contextProviderClassName == null) {
    contextProviderClassName=config.getPortletContext().getInitParameter(ServletContextProvider.class.getName());
  }
  if (contextProviderClassName == null) {
    wicketPortletProperties=getWicketPortletProperties(wicketPortletProperties);
    contextProviderClassName=wicketPortletProperties.getProperty(ServletContextProvider.class.getName());
  }
  if (contextProviderClassName == null) {
    throw new PortletException("Portlet " + config.getPortletName() + " is incorrectly configured. Init parameter "+ PARAM_SERVLET_CONTEXT_PROVIDER+ " not specified, nor as context parameter "+ ServletContextProvider.class.getName()+ " or as property in "+ WICKET_PORTLET_PROPERTIES+ " in the classpath.");
  }
  try {
    Class clazz=Class.forName(contextProviderClassName);
    servletContextProvider=(ServletContextProvider)clazz.newInstance();
  }
 catch (  Exception e) {
    if (e instanceof PortletException) {
      throw (PortletException)e;
    }
    throw new PortletException("Initialization failure",e);
  }
  String resourceURLFactoryClassName=getPortletResourceURLFactoryClassNameParameter(config);
  if (resourceURLFactoryClassName == null) {
    resourceURLFactoryClassName=config.getPortletContext().getInitParameter(PortletResourceURLFactory.class.getName());
  }
  if (resourceURLFactoryClassName == null) {
    wicketPortletProperties=getWicketPortletProperties(wicketPortletProperties);
    resourceURLFactoryClassName=wicketPortletProperties.getProperty(PortletResourceURLFactory.class.getName());
  }
  if (resourceURLFactoryClassName == null) {
    throw new PortletException("Portlet " + config.getPortletName() + " is incorrectly configured. Init parameter "+ PARAM_PORTLET_RESOURCE_URL_FACTORY+ " not specified, nor as context parameter "+ PortletResourceURLFactory.class.getName()+ " or as property in "+ WICKET_PORTLET_PROPERTIES+ " in the classpath.");
  }
  try {
    Class clazz=Class.forName(resourceURLFactoryClassName);
    resourceURLFactory=(PortletResourceURLFactory)clazz.newInstance();
  }
 catch (  Exception e) {
    if (e instanceof PortletException) {
      throw (PortletException)e;
    }
    throw new PortletException("Initialization failure",e);
  }
  wicketFilterPath=buildWicketFilterPath(config.getInitParameter(WICKET_FILTER_PATH_PARAM));
  wicketFilterQuery=buildWicketFilterQuery(wicketFilterPath);
  defaultPages.put(PARAM_VIEW_PAGE,config.getInitParameter(PARAM_VIEW_PAGE));
  defaultPages.put(PARAM_ACTION_PAGE,config.getInitParameter(PARAM_ACTION_PAGE));
  defaultPages.put(PARAM_CUSTOM_PAGE,config.getInitParameter(PARAM_CUSTOM_PAGE));
  defaultPages.put(PARAM_HELP_PAGE,config.getInitParameter(PARAM_HELP_PAGE));
  defaultPages.put(PARAM_EDIT_PAGE,config.getInitParameter(PARAM_EDIT_PAGE));
  validateDefaultPages(defaultPages,wicketFilterPath,wicketFilterQuery);
}
