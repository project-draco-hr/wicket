{
  final Session session=requestCycle.getSession();
  final Application application=session.getApplication();
  try {
    Class homePageClass=application.getPages().getHomePage();
    PageClassRequestTarget pokeTarget=new PageClassRequestTarget(homePageClass);
    IRequestEncoder requestEncoder=requestCycle.getRequestCycleProcessor().getRequestEncoder();
    String path=requestEncoder.getMountedPath(pokeTarget);
    if (path != null) {
      requestCycle.setRedirect(true);
      return pokeTarget;
    }
    final PageParameters parameters=new PageParameters(requestParameters.getParameters());
    Page newPage=session.getPageFactory().newPage(homePageClass,parameters);
    IRequestTarget requestTarget=requestCycle.getRequestTarget();
    if (!(requestTarget instanceof IPageRequestTarget || requestTarget instanceof IPageClassRequestTarget)) {
      requestTarget=new PageRequestTarget(newPage);
    }
    return requestTarget;
  }
 catch (  WicketRuntimeException e) {
    throw new WicketRuntimeException("Could not create home page",e);
  }
}
