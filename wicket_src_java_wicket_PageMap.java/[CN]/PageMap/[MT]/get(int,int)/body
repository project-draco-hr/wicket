{
  final IPageMapEntry entry=(IPageMapEntry)session.getAttribute(attributeForId(id));
  if (entry != null) {
    access(entry,versionNumber);
    Page page=entry.getPage();
    page.dirty();
    final Page version=page.getVersion(versionNumber);
    if (version != null) {
      if (version != page) {
        page=version;
        page.getPageMap().put(page.getPageMapEntry());
      }
    }
 else {
      throw new IllegalStateException("Unable to get version " + versionNumber + " of page "+ page);
    }
    return page;
  }
  return null;
}
