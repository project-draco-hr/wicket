{
  Session session=null;
  try {
    SessionFactory sessionFactory=configuration.buildSessionFactory();
    Dialect dialect=((SessionFactoryImpl)sessionFactory).getDialect();
    String[] drops=configuration.generateDropSchemaScript(dialect);
    String[] creates=configuration.generateSchemaCreationScript(dialect);
    session=sessionFactory.openSession();
    Connection conn=session.connection();
    Statement stmt=conn.createStatement();
    execStmt(conn,stmt,splitAltTables(drops,true));
    execStmt(conn,stmt,splitAltTables(drops,false));
    execStmt(conn,stmt,creates);
    insertTestData(session);
  }
 catch (  HibernateException e) {
    throw new RuntimeException(e);
  }
catch (  SQLException e) {
    throw new RuntimeException(e);
  }
 finally {
    try {
      session.close();
    }
 catch (    HibernateException e) {
      e.printStackTrace();
    }
  }
}
