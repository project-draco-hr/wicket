{
  if (obj == null) {
    throw new IllegalArgumentException("null input: obj");
  }
  final IdentityHashMap visited=new IdentityHashMap();
  final ObjectProfileNode root=createProfileTree(obj,visited,CLASS_METADATA_CACHE);
  finishProfileTree(root);
  return root;
}
