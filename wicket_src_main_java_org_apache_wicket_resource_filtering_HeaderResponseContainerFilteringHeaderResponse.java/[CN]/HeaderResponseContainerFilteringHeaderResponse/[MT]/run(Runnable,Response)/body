{
  if (AjaxRequestTarget.get() != null) {
    runnable.run();
    return;
  }
  Response original=RequestCycle.get().setResponse(response);
  try {
    runnable.run();
  }
 catch (  RuntimeException ex) {
    throw ex;
  }
 finally {
    RequestCycle.get().setResponse(original);
  }
}
