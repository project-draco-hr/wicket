{
  if (this instanceof Page) {
    ((Page)this).renderPage();
  }
 else {
    MarkupContainer parent=getParent();
    MarkupStream originalMarkupStream=parent.getMarkupStream();
    MarkupStream markupStream=locateMarkupStream();
    try {
      parent.setMarkupStream(markupStream);
      prepareForRender();
      render(markupStream);
    }
  finally {
      parent.setMarkupStream(originalMarkupStream);
      afterRender();
    }
  }
}
