{
  tester.startPage(EmailPage.class);
  assertEquals(EmailPage.class,tester.getLastRenderedPage().getClass());
  EmailPage page=(EmailPage)tester.getLastRenderedPage();
  FormTester formTester=tester.newFormTester("form");
  formTester.setValue("email","a");
  formTester.submit();
  assertEquals(EmailPage.class,tester.getLastRenderedPage().getClass());
  page=(EmailPage)tester.getLastRenderedPage();
  assertNull(page.getEmail());
  assertTrue(Session.get().getFeedbackMessages().hasMessageFor(page.get("form:email")));
  final List<FeedbackMessage> messages=Session.get().getFeedbackMessages().messagesForComponent(page.get("form:email"));
  assertEquals(1,messages.size());
  assertEquals("wrong email address pattern for email",messages.get(0).getMessage().toString());
}
