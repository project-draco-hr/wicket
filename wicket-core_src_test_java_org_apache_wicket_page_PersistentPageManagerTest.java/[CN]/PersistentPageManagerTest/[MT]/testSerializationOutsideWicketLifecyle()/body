{
  IPageManager pageManager=newPersistentPageManager("test_app");
  TestPage toSerializePage=new TestPage();
  pageManager.touchPage(toSerializePage);
  pageManager.commitRequest();
  pageManager.destroy();
  Serializable sessionEntry=pageManager.getContext().getSessionAttribute(null);
  byte[] serializedSessionEntry=WicketObjects.objectToByteArray(sessionEntry);
  assertTrue("ok, wicket was able to serialize the session entry",true);
  IPageManager newPageManager=newPersistentPageManager("test_app");
  ObjectInputStream in=new ObjectInputStream(new ByteArrayInputStream(serializedSessionEntry));
  assertNull("Worker thread should be unaware of Wicket application",in.readObject());
  Serializable loadedSessionEntry=(Serializable)in.readObject();
  assertNotNull("Wicket needs to be able to deserialize the session entry regardless the application availability",loadedSessionEntry);
  newPageManager.getContext().setSessionAttribute(null,loadedSessionEntry);
  TestPage deserializedPage=(TestPage)newPageManager.getPage(toSerializePage.getPageId());
  assertNotNull(deserializedPage);
  assertEquals(toSerializePage.instanceID,deserializedPage.instanceID);
  newPageManager.destroy();
}
