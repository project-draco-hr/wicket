{
  internalOnBeginRender();
  onBeginRender();
  if (log.isDebugEnabled()) {
    log.debug("Begin render " + this);
  }
  RuntimeException renderException=null;
  try {
    final RequestCycle cycle=getRequestCycle();
    final Response originalResponse=cycle.getResponse();
    if (!isVisible()) {
      cycle.setResponse(NullResponse.getInstance());
    }
synchronized (getModelLock()) {
      onRender();
      getPage().componentRendered(this);
    }
    cycle.setResponse(originalResponse);
  }
 catch (  RuntimeException e) {
    renderException=e;
    throw e;
  }
 finally {
    if (log.isDebugEnabled()) {
      log.debug("End render " + this);
    }
    try {
      onEndRender();
      internalOnEndRender();
      detachModels();
    }
 catch (    RuntimeException e) {
      throw new WicketRuntimeException("Exception thrown while cleaning up from the following exception which was thrown during rendering: " + Strings.toString(renderException),e);
    }
  }
}
