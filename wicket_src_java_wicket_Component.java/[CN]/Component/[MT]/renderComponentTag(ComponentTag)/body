{
  final ApplicationSettings settings=getApplication().getSettings();
  if (!(tag instanceof ComponentWicketTag) || !settings.getStripWicketTags()) {
    if ((attributeModifiers != null) && (tag.getType() != XmlTag.CLOSE)) {
      tag=tag.mutable();
      for (Iterator it=attributeModifiers.iterator(); it.hasNext(); ) {
        ((AttributeModifier)it.next()).replaceAttibuteValue(tag);
      }
    }
    if (settings.getStripComponentIds()) {
      tag=tag.mutable();
      tag.removeComponentId(settings.getComponentIdAttribute(),settings.getApplyDefaultComponentId());
    }
    getResponse().write(tag);
  }
}
