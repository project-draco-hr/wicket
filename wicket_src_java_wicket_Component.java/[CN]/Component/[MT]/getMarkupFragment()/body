{
  String path=getId();
  MarkupContainer parent=getParent();
  while ((parent != null) && !(parent instanceof IMarkupProvider)) {
    path=parent.getMarkupFragmentPath(path);
    parent=parent.getParent();
  }
  if (parent == null) {
    throw new MarkupNotFoundException("Component has no parent with external markup file: " + getId());
  }
  try {
    return ((IMarkupProvider)parent).getMarkupFragment(path);
  }
 catch (  WicketRuntimeException ex) {
  }
  Iterator iter=parent.iterator();
  while (iter.hasNext()) {
    Component child=(Component)iter.next();
    if (child instanceof WebMarkupContainerWithAssociatedMarkup) {
      WebMarkupContainerWithAssociatedMarkup container=(WebMarkupContainerWithAssociatedMarkup)child;
      if (container.isTransparentResolver()) {
        MarkupFragment fragment=container.getMarkupFragment(path);
        if (fragment != null) {
          return fragment;
        }
      }
    }
  }
  throw new MarkupNotFoundException("Unable to find the markup fragment with markup path '" + path + "'. Component: "+ getId());
}
