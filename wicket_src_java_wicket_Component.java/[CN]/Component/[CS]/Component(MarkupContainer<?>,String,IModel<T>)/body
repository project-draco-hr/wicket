{
  setId(id);
  if (parent == null) {
    if (!(this instanceof Page)) {
      throw new WicketRuntimeException("component without a parent is not allowed.");
    }
  }
 else   if (parent instanceof IAlternateParentProvider) {
    while (parent instanceof IAlternateParentProvider) {
      MarkupContainer oldParent=parent;
      parent=((IAlternateParentProvider)parent).getAlternateParent(this.getClass(),id);
      if (parent == oldParent) {
        break;
      }
      if (!oldParent.contains(parent,true)) {
        throw new WicketRuntimeException("IAlternateParentProvider cannot return alternate parent containers that are outside its hierarchy.");
      }
    }
  }
  this.parent=parent;
  getApplication().notifyComponentInstantiationListeners(this);
  if (id.startsWith(AUTO_COMPONENT_PREFIX)) {
    parent.autoAdd(this);
  }
 else {
    loadMarkupStream();
    parent.add(this);
  }
  if (model instanceof IAssignmentAware) {
    this.model=((IAssignmentAware)model).wrapOnAssignment(this);
  }
 else {
    this.model=model;
  }
}
