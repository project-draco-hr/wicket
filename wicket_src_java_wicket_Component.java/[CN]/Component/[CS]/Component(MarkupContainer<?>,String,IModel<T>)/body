{
  if (parent == null) {
    if (!(this instanceof Page)) {
      throw new WicketRuntimeException("component without a parent is not allowed.");
    }
  }
  this.parent=parent;
  setId(id);
  getApplication().notifyComponentInstantiationListeners(this);
  if (id.startsWith(AUTO_COMPONENT_PREFIX)) {
    parent.autoAdd(this);
  }
 else {
    try {
      MarkupStream markupStream=MarkupFragmentFinder.find(this);
      ComponentTag tag=markupStream.getTag();
      if (tag.hasAttributes()) {
        markupAttributes=new CopyOnWriteValueMap(tag.getAttributes());
      }
    }
 catch (    MarkupException ex) {
      log.warn("MarkupFragmentFinder was unable to find the markup associated with Component '" + id + "'. You will not be able to use the component for AJAX calls.");
    }
catch (    RuntimeException re) {
      log.warn("MarkupFragmentFinder was unable to find the markup associated with Component '" + id + "'. You will not be able to use the component for AJAX calls.");
    }
    parent.add(this);
  }
  if (model instanceof IAssignmentAware) {
    this.model=((IAssignmentAware)model).wrapOnAssignment(this);
  }
 else {
    this.model=model;
  }
}
