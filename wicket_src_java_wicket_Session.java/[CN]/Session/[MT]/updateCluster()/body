{
  if (dirty) {
    if (log.isDebugEnabled())     log.debug("updateCluster(): Session is dirty.  Replicating.");
    this.dirty=false;
    setAttribute(sessionAttributeName,this);
  }
 else {
    if (log.isDebugEnabled()) {
      log.debug("updateCluster(): Session not dirty.");
    }
  }
  visitPageMaps(new IVisitor(){
    public void pageMap(    PageMap pageMap){
      pageMap.visitPages(new PageMap.IVisitor(){
        public void page(        Page page){
          if (page.isDirty()) {
            page.setDirty(false);
            replicate(page);
          }
        }
      }
);
    }
  }
);
}
