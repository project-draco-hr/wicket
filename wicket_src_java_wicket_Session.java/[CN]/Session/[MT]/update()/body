{
  if (dirty) {
    if (log.isDebugEnabled()) {
      log.debug("update: Session is dirty.  Replicating.");
    }
    this.dirty=false;
    setAttribute(SESSION_ATTRIBUTE_NAME,this);
  }
 else {
    if (log.isDebugEnabled()) {
      log.debug("update: Session not dirty.");
    }
  }
  for (final Iterator iterator=getAttributeNames().iterator(); iterator.hasNext(); ) {
    final String attribute=(String)iterator.next();
    if (attribute.startsWith(pageMapEntryAttributePrefix)) {
      IPageMapEntry entry=(IPageMapEntry)getAttribute(attribute);
      if (entry.isDirty()) {
        entry.setDirty(false);
        setAttribute(attribute,entry);
      }
    }
  }
}
