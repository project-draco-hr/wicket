{
  final State state=(State)getAttribute("state");
  if (state != null) {
    this.state=state;
  }
  for (final Iterator iterator=getAttributeNames().iterator(); iterator.hasNext(); ) {
    final String attributeName=(String)iterator.next();
    final Object value=getAttribute(attributeName);
    if (value instanceof PageState) {
      final PageState pageState=(PageState)value;
      if (!pageState.addedToSession()) {
        final Page page=pageState.getPage();
        getPageMap().put(new Integer(page.getId()),page);
        pageState.addedToSession=true;
      }
    }
  }
}
