{
  try {
    final ByteArrayOutputStream out=new ByteArrayOutputStream();
    try {
      new WicketObjectOutputStream(out).writeObject(object);
    }
  finally {
      out.close();
    }
    return out.toByteArray();
  }
 catch (  IOException e) {
    try {
      Objects.checkSerializable(object);
    }
 catch (    Exception e1) {
      log.error("Error serializing object " + object.getClass() + "["+ object+ "]");
    }
  }
  return null;
}
