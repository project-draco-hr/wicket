{
  try {
    final ByteArrayOutputStream out=new ByteArrayOutputStream();
    try {
      objectStreamFactory.newObjectOutputStream(out).writeObject(object);
    }
  finally {
      out.close();
    }
    return out.toByteArray();
  }
 catch (  IOException e) {
    if ((e instanceof NotSerializableException) && SerializableChecker.isAvailable()) {
      try {
        new SerializableChecker((NotSerializableException)e).writeObject(object);
        logSerializationException(object,e);
      }
 catch (      Exception e1) {
        logSerializationException(object,e1);
      }
    }
 else {
      logSerializationException(object,e);
    }
  }
  return null;
}
