{
  try {
    final ByteArrayOutputStream out=new ByteArrayOutputStream();
    try {
      new ObjectOutputStream(out).writeObject(object);
    }
  finally {
      out.close();
    }
    return out.toByteArray();
  }
 catch (  IOException e) {
    if (SerializableChecker.isAvailable()) {
      try {
        new SerializableChecker(object).check();
      }
 catch (      Exception e1) {
        log.error("Error serializing object " + object.getClass() + " [object="+ object+ "]",e1);
      }
    }
 else {
      log.error("Error serializing object " + object.getClass() + " [object="+ object+ "]",e);
    }
  }
  return null;
}
