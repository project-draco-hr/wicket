{
  Application.set(this);
  context=new MockServletContext(this,path);
  setWicketServlet(new WicketServlet(){
    private static final long serialVersionUID=1L;
    public ServletContext getServletContext(){
      return context;
    }
    /** 
 * @see javax.servlet.GenericServlet#getInitParameter(java.lang.String)
 */
    public String getInitParameter(    String name){
      return null;
    }
    /** 
 * @see javax.servlet.GenericServlet#getServletName()
 */
    public String getServletName(){
      return "WicketMockServlet";
    }
  }
);
  internalInit();
  servletSession=new MockHttpSession(context);
  servletRequest=new MockHttpServletRequest(this,servletSession,context);
  servletResponse=new MockHttpServletResponse();
  wicketRequest=newWebRequest(servletRequest);
  wicketSession=getSession(wicketRequest);
  getApplicationSettings().setContextPath(context.getServletContextName());
  getRequestCycleSettings().setRenderStrategy(IRequestCycleSettings.ONE_PASS_RENDER);
  getResourceSettings().setResourceFinder(new WebApplicationPath(context));
  createRequestCycle();
}
