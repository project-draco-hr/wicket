{
  ServletContext context=getServletContext();
  servletSession=new MockHttpSession(context);
  servletRequest=new MockHttpServletRequest(this,servletSession,context);
  servletResponse=new MockHttpServletResponse();
  wicketRequest=newWebRequest(servletRequest);
  wicketSession=getSession(wicketRequest);
  getApplicationSettings().setContextPath(context.getServletContextName());
  getRequestCycleSettings().setRenderStrategy(RenderStrategy.ONE_PASS_RENDER);
  getResourceSettings().setResourceFinder(new WebApplicationPath(context));
  getPageSettings().setAutomaticMultiWindowSupport(false);
  createRequestCycle();
}
