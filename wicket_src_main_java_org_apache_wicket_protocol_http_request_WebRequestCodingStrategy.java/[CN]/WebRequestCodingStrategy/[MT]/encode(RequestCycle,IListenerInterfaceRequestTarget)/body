{
  final RequestListenerInterface rli=requestTarget.getRequestListenerInterface();
  final AppendingStringBuffer url=new AppendingStringBuffer(64);
  url.append('?');
  url.append(INTERFACE_PARAMETER_NAME);
  url.append('=');
  final Component component=requestTarget.getTarget();
  final Page page=component.getPage();
  url.append(Component.PATH_SEPARATOR);
  url.append(component.getPath());
  url.append(Component.PATH_SEPARATOR);
  final int versionNumber=0;
  if (!rli.getRecordsPageVersion()) {
    url.append(Page.LATEST_VERSION);
  }
 else   if (versionNumber > 0) {
    url.append(versionNumber);
  }
  url.append(Component.PATH_SEPARATOR);
  final String listenerName=rli.getName();
  if (!IRedirectListener.INTERFACE.getName().equals(listenerName)) {
    url.append(listenerName);
  }
  url.append(Component.PATH_SEPARATOR);
  RequestParameters params=requestTarget.getRequestParameters();
  if (params != null && params.getBehaviorId() != null) {
    url.append(params.getBehaviorId());
  }
  url.append(Component.PATH_SEPARATOR);
  if (params != null && params.getUrlDepth() != 0) {
    url.append(params.getUrlDepth());
  }
  if (IActivePageBehaviorListener.INTERFACE.getName().equals(listenerName)) {
    url.append(url.indexOf("?") > -1 ? "&" : "?").append(IGNORE_IF_NOT_ACTIVE_PARAMETER_NAME).append("=true");
  }
  return url;
}
