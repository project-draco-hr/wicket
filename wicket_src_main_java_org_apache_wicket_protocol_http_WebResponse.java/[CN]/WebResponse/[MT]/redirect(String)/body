{
  if (!redirect) {
    if (httpServletResponse != null) {
      url=httpServletResponse.encodeRedirectURL(url);
      try {
        if (httpServletResponse.isCommitted()) {
          log.error("Unable to redirect to: " + url + ", HTTP Response has already been committed.");
        }
        if (log.isDebugEnabled()) {
          log.debug("Redirecting to " + url);
        }
        if (isAjax()) {
          httpServletResponse.addHeader("Ajax-Location",url);
          httpServletResponse.getWriter().write(" ");
        }
 else {
          httpServletResponse.sendRedirect(url);
        }
        redirect=true;
      }
 catch (      IOException e) {
        log.warn("redirect to " + url + " failed: "+ e.getMessage());
      }
    }
  }
 else {
    log.info("Already redirecting to an url current one ignored: " + url);
  }
}
