{
  checkComponentTag(tag,"option");
  Select select=(Select)findParent(Select.class);
  if (select == null) {
    throw new WicketRuntimeException("SelectOption component [" + getPath() + "] cannot find its parent Select. All SelectOption components must be a child of or below in the hierarchy of a Select component.");
  }
  tag.put("value",getPath());
  Object selected=select.getModelObject();
  if (selected == null) {
    throw new WicketRuntimeException("Select [" + select.getPath() + "] contains a null model object, must be an object of type java.lang.Object or java.util.Collection (in case of multi-valued select element");
  }
  boolean isSelected=false;
  Object value=getModelObject();
  if (selected instanceof Collection) {
    if (value instanceof Collection) {
      isSelected=selected.equals(value);
    }
 else {
      isSelected=((Collection)selected).contains(value);
    }
  }
 else {
    isSelected=selected.equals(value);
  }
  if (isSelected) {
    tag.put("selected","true");
  }
  super.onComponentTag(tag);
}
