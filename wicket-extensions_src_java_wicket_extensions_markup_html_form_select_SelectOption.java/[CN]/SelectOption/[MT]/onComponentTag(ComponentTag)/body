{
  checkComponentTag(tag,"option");
  Select select=(Select)findParent(Select.class);
  if (select == null) {
    throw new WicketRuntimeException("SelectOption component [" + getPath() + "] cannot find its parent Select. All SelectOption components must be a child of or below in the hierarchy of a Select component.");
  }
  tag.put("value",getPath());
  Object selected=select.getModelObject();
  boolean isSelected=false;
  T value=getModelObject();
  if ((selected != null) && (selected instanceof Collection)) {
    if (value instanceof Collection) {
      isSelected=selected.equals(value);
    }
 else {
      isSelected=((Collection)selected).contains(value);
    }
  }
 else {
    isSelected=Objects.equal(selected,value);
  }
  if (isSelected) {
    tag.put("selected","true");
  }
  super.onComponentTag(tag);
}
