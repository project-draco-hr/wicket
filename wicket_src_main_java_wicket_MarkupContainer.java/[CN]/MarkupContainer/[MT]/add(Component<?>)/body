{
  if (child == null) {
    throw new IllegalArgumentException("argument child may not be null");
  }
  if (log.isDebugEnabled()) {
    log.debug("Add " + child.getId() + " to component "+ this.getClass().getName()+ " with path "+ getPath());
  }
  addedComponent(child);
  Component replaced=put(child);
  child.setFlag(FLAG_REMOVED_FROM_PARENT,false);
  if (replaced != null) {
    replaced.setFlag(FLAG_REMOVED_FROM_PARENT,true);
    removedComponent(replaced);
    child.markupIndex=replaced.markupIndex;
    String replacedId=(replaced.hasMarkupIdMetaData()) ? replaced.getMarkupId() : null;
    child.setMarkupIdMetaData(replacedId);
  }
  return this;
}
