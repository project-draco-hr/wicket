{
  if (!storeAfterSessionReplication() || serializable instanceof Page) {
    return serializable;
  }
 else   if (serializable instanceof SerializedPageWithSession) {
    SerializedPageWithSession page=(SerializedPageWithSession)serializable;
    if (page.page == null || page.page.get() != SerializedPageWithSession.NO_PAGE) {
      storeSerializedPages(page.sessionId,page.pages);
      return stripSerializedPage(page);
    }
 else {
      return page;
    }
  }
 else {
    String type=serializable != null ? serializable.getClass().getName() : null;
    throw new IllegalArgumentException("Unknown object type " + type);
  }
}
