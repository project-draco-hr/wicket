{
  Args.notNull(component,"component");
  Page page=createPage();
  if (page == null) {
    fail("The automatically created page should not be null.");
  }
  if (pageMarkup == null) {
    String markup=createPageMarkup(component.getId());
    if (markup == null) {
      fail("The markup for the automatically created page should not be null.");
    }
    markup="<html><head></head><body>" + markup + "</body></html>";
    ContainerInfo containerInfo=Mockito.mock(ContainerInfo.class);
    Mockito.when(containerInfo.getContainerClass()).thenReturn(page.getClass());
    MarkupResourceStream markupResourceStream=new MarkupResourceStream(new StringResourceStream(markup),containerInfo,page.getClass());
    try {
      pageMarkup=new MarkupParser(markupResourceStream).parse();
    }
 catch (    Exception e) {
      fail("Error while parsing the markup for the autogenerated page: " + e.getMessage());
    }
  }
  page.setMarkup(pageMarkup);
  page.add(component);
  startPage(page);
  startComponent=component;
  return component;
}
