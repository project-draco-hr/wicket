{
  if (component != null && component.getPage() != null) {
    Stack searchStack=new Stack();
    searchStack.push(component);
    if (!(component instanceof Page)) {
      MarkupContainer c=component.getParent();
      while (true) {
        searchStack.push(c);
        if (c instanceof Page)         break;
        c=c.getParent();
      }
    }
    String value=null;
    while (!searchStack.isEmpty()) {
      Component c=(Component)searchStack.pop();
      Class cc=c.getClass();
      while (value == null) {
        final String id=createCacheId(cc,style,locale);
        ValueMap strings=(ValueMap)resourceCache.get(id);
        if (strings == null) {
          strings=loadResources(c,cc,style,locale,id);
        }
        value=strings.getString(key);
        if (value != null)         break;
        cc=cc.getSuperclass();
        if (isStopResourceSearch(cc))         break;
      }
      if (value != null)       break;
    }
    return value;
  }
  return null;
}
