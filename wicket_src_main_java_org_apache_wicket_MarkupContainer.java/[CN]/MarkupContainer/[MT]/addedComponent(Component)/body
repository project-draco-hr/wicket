{
  if (child == this) {
    throw new IllegalArgumentException("Component can't be added to itself");
  }
  MarkupContainer parent=child.getParent();
  if (parent != null) {
    parent.remove(child);
  }
  child.setParent(this);
  final IDebugSettings debugSettings=Application.get().getDebugSettings();
  if (debugSettings.isLinePreciseReportingOnAddComponentEnabled()) {
    child.setMetaData(ADDED_AT_KEY,ComponentStrings.toString(child,new MarkupException("added")));
  }
  final Page page=findPage();
  if (page != null) {
    page.componentAdded(child);
    child.initialize();
  }
  if (isPreparedForRender()) {
    child.beforeRender();
  }
}
