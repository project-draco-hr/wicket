{
  Args.notNull(child,"child");
  MarkupContainer parent=child.getParent();
  if (parent != null) {
    parent.remove(child);
  }
  child.setParent(this);
  final DebugSettings debugSettings=Application.get().getDebugSettings();
  if (debugSettings.isLinePreciseReportingOnAddComponentEnabled() && debugSettings.getComponentUseCheck()) {
    child.setMetaData(ADDED_AT_KEY,ComponentStrings.toString(child,new MarkupException("added")));
  }
  Page page=null;
  MarkupContainer queueRegion=null;
  Component cursor=this;
  while (cursor != null) {
    if (queueRegion == null && (cursor instanceof IQueueRegion)) {
      queueRegion=(MarkupContainer)cursor;
    }
    if (cursor instanceof Page) {
      page=(Page)cursor;
    }
    cursor=cursor.getParent();
  }
  if (page != null) {
    if (!queueRegion.getRequestFlag(RFLAG_CONTAINER_DEQUEING)) {
      if (!child.isAuto()) {
        queueRegion.dequeue();
      }
    }
  }
  if (page != null) {
    page.componentAdded(child);
    if (page.isInitialized()) {
      child.internalInitialize();
    }
  }
  if (isPreparedForRender()) {
    child.beforeRender();
  }
}
