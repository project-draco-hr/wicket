{
  final MarkupStream markupStream=container.getAssociatedMarkupStream(false);
  if (markupStream == null) {
    return;
  }
  while (nextHeaderMarkup(markupStream) != -1) {
    Class markupClass=((WicketTag)markupStream.getTag()).getWicketHeaderClass();
    if (markupClass == null) {
      markupClass=markupStream.getContainerClass();
    }
    final HeaderPartContainer headerPart=getHeaderPart(markupClass,markupStream.getCurrentIndex());
    if (headerPart != null) {
      if (htmlContainer.okToRenderComponent(headerPart.getScope(),headerPart.getId())) {
        htmlContainer.autoAdd(headerPart);
        if (checkedBody == false) {
          checkedBody=true;
          checkBodyOnLoad();
        }
      }
 else {
        Response response=container.getRequestCycle().getResponse();
        try {
          container.getRequestCycle().setResponse(NullResponse.getInstance());
          htmlContainer.autoAdd(headerPart);
        }
  finally {
          container.getRequestCycle().setResponse(response);
        }
      }
    }
    markupStream.skipComponent();
  }
}
