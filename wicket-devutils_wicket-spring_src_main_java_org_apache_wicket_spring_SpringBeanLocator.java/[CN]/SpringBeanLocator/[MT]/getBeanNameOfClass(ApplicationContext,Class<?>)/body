{
  String[] names=BeanFactoryUtils.beanNamesForTypeIncludingAncestors(ctx,clazz);
  if (names.length == 0) {
    throw new IllegalStateException("bean of type [" + clazz.getName() + "] not found");
  }
  if (names.length > 1) {
    StringBuffer msg=new StringBuffer();
    msg.append("more then one bean of type [");
    msg.append(clazz.getName());
    msg.append("] found, you have to specify the name of the bean ");
    msg.append("(@SpringBean(name=\"foo\")) in order to resolve this conflict. ");
    msg.append("Matched beans: ");
    msg.append(Strings.join(",",names));
    throw new IllegalStateException(msg.toString());
  }
  return names[0];
}
