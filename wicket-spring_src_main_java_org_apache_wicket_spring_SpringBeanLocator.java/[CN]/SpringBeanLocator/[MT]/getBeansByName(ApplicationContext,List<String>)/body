{
  List<Object> beansAsList=new ArrayList<>();
  for (  String beanName : names) {
    RootBeanDefinition beanDef=getBeanDefinition(ctx,beanName);
    if (beanDef == null) {
      continue;
    }
    ResolvableType candidateResolvableType=null;
    if (beanDef.hasBeanClass()) {
      candidateResolvableType=ResolvableType.forClass(beanDef.getBeanClass());
    }
 else     if (beanDef.getResolvedFactoryMethod() != null) {
      candidateResolvableType=ResolvableType.forMethodReturnType(beanDef.getResolvedFactoryMethod());
    }
    if (candidateResolvableType == null) {
      continue;
    }
    boolean exactMatch=fieldResolvableType.isAssignableFrom(candidateResolvableType);
    boolean elementMatch=fieldCollectionResolvableType != null ? fieldCollectionResolvableType.isAssignableFrom(candidateResolvableType) : false;
    if (exactMatch || elementMatch) {
      beansAsList.add(ctx.getBean(beanName));
    }
    if (exactMatch) {
      this.beanName=beanName;
      return ctx.getBean(beanName);
    }
  }
  return beansAsList.size() > 0 ? beansAsList : null;
}
