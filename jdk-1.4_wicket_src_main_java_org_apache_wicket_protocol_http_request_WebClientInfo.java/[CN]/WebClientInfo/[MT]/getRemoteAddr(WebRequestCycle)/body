{
  HttpServletRequest httpServletReq=requestCycle.getWebRequest().getHttpServletRequest();
  String remoteAddr=httpServletReq.getHeader("X-Forwarded-For");
  if (remoteAddr == null) {
    remoteAddr=httpServletReq.getRemoteAddr();
  }
 else {
    if (remoteAddr.indexOf(",") != -1) {
      remoteAddr=remoteAddr.split(",")[0].trim();
    }
  }
  return remoteAddr;
}
