{
  final String renderedUrl;
  if (shouldRenderAsFull(url)) {
    if (url.isAbsolute() == false) {
      String relativeUrl=renderRelativeUrl(url);
      Url relative=Url.parse(relativeUrl,url.getCharset());
      relative.setPort(url.getPort());
      relative.setProtocol(url.getProtocol());
      renderedUrl=renderFullUrl(relative);
    }
 else {
      renderedUrl=renderFullUrl(url);
    }
  }
 else {
    renderedUrl=renderRelativeUrl(url);
  }
  return renderedUrl;
}
