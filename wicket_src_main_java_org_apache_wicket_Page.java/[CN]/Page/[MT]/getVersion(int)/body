{
  if (versionManager == null) {
    if (versionNumber == 0 || versionNumber == LATEST_VERSION) {
      return this;
    }
 else {
      log.info("No version manager available to retrieve requested versionNumber " + versionNumber);
      return null;
    }
  }
 else {
    final boolean originalTrackChanges=getFlag(FLAG_TRACK_CHANGES);
    try {
      setFlag(FLAG_TRACK_CHANGES,false);
      final Page page;
      if (versionNumber != LATEST_VERSION) {
        page=versionManager.getVersion(versionNumber);
      }
 else {
        page=versionManager.getVersion(getCurrentVersionNumber());
      }
      if (page != null && page.getCurrentVersionNumber() == 0 && page.getAjaxVersionNumber() == 0) {
        page.versionManager=null;
      }
      return page;
    }
  finally {
      setFlag(FLAG_TRACK_CHANGES,originalTrackChanges);
    }
  }
}
