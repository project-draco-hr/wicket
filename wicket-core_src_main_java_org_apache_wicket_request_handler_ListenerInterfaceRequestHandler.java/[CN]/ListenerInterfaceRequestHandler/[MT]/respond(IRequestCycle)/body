{
  final IRequestablePage page=getPage();
  if (getComponent().getPage() == page) {
    boolean isAjax=((WebRequest)requestCycle.getRequest()).isAjax();
    if (isAjax == false && listenerInterface.isRenderPageAfterInvocation()) {
      final IPageProvider pageProvider;
      final RedirectPolicy policy;
      if (page.isPageStateless()) {
        policy=RedirectPolicy.NEVER_REDIRECT;
        pageProvider=new PageProvider(page.getPageId(),page.getClass(),page.getPageParameters(),page.getRenderCount());
      }
 else {
        policy=RedirectPolicy.AUTO_REDIRECT;
        pageProvider=new PageProvider(page);
      }
      requestCycle.scheduleRequestHandlerAfterCurrent(new RenderPageRequestHandler(pageProvider,policy));
    }
    invokeListener();
  }
 else {
    throw new WicketRuntimeException("Component " + getComponent() + " has been removed from page.");
  }
}
