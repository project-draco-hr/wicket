{
  if ("href".equals(attribute) || "src".equals(attribute)) {
    RequestContext rc=RequestContext.get();
    if (rc.isPortletRequest() && !(value.startsWith("http://") || value.startsWith("https://"))) {
      if ("href".equals(attribute)) {
        value=((PortletRequestContext)rc).encodeRenderURL(value).toString();
      }
 else {
        value=((PortletRequestContext)rc).encodeSharedResourceURL(value).toString();
      }
    }
  }
  return value;
}
