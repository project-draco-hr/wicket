{
  final int readAheadSize=80;
  inputStream.mark(readAheadSize);
  if (getXmlDeclaration(inputStream,readAheadSize)) {
    encoding=determineEncoding(xmlDeclarationString);
  }
 else {
    inputStream.reset();
  }
  if (encoding == null) {
    reader=new InputStreamReader(inputStream);
  }
 else {
    reader=new InputStreamReader(inputStream,encoding);
  }
}
