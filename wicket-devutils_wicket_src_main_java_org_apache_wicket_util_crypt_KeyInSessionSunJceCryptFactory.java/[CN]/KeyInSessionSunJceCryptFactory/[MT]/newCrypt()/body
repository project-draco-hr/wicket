{
  WebRequestCycle rc=(WebRequestCycle)RequestCycle.get();
  HttpSession session=rc.getWebRequest().getHttpServletRequest().getSession(true);
  final String keyAttr=rc.getApplication().getApplicationKey() + "." + getClass().getName();
  String key=(String)session.getAttribute(keyAttr);
  if (key == null) {
    key=session.getId() + "." + UUID.randomUUID().toString();
    session.setAttribute(keyAttr,key);
  }
  ICrypt crypt=new SunJceCrypt();
  crypt.setKey(key);
  return crypt;
}
