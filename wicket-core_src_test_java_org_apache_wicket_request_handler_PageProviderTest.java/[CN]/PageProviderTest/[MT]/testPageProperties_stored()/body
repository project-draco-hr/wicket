{
  TestMapperContext mapperContext=new TestMapperContext();
  Page page=new TestPage();
  mapperContext.getPageManager().touchPage(page);
  mapperContext.getPageManager().commitRequest();
  mapperContext.cleanSessionCache();
  PageProvider provider=mapperContext.new TestPageProvider(page.getPageId(),0);
  assertFalse(provider.hasPageInstance());
  try {
    provider.isPageInstanceFresh();
    fail("expected illegal state exception");
  }
 catch (  IllegalStateException e) {
  }
  provider.getPageInstance();
  assertTrue(provider.hasPageInstance());
  assertFalse(provider.isPageInstanceFresh());
}
