{
  final Form<?> processingForm=findFormToProcess(submittingComponent);
  if (submittingComponent == null) {
    submitFormsIncludingNested(processingForm);
  }
 else {
    final SubmitOrder submitOrder=submittingComponent.getSubmitOrder();
switch (submitOrder) {
case BEFORE_FORM:
      submittingComponent.onSubmit();
    submitFormsIncludingNested(processingForm);
  break;
case AFTER_FORM:
submitFormsIncludingNested(processingForm);
submittingComponent.onSubmit();
break;
default :
throw new IllegalStateException("unknown submitorder: " + submitOrder);
}
}
}
