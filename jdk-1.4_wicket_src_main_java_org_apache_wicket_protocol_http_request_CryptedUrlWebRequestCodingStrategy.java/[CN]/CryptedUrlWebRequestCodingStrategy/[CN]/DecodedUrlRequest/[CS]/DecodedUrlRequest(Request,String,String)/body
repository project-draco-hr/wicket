{
  this.request=request;
  this.parameterMap=this.request.getParameterMap();
  this.parameterMap.remove("x");
  String decodedParamReplacement=encodedParamReplacement;
  try {
    decodedParamReplacement=URLDecoder.decode(encodedParamReplacement,Application.get().getRequestCycleSettings().getResponseRequestEncoding());
  }
 catch (  UnsupportedEncodingException ex) {
    log.error("error decoding url: " + encodedParamReplacement,ex);
  }
  ValueMap params=new ValueMap();
  RequestUtils.decodeParameters(decodedParamReplacement,params);
  this.parameterMap.putAll(params);
  int pos1=url.indexOf("?x=");
  if (pos1 == -1) {
    throw new WicketRuntimeException("Programming error: we should come here");
  }
  int pos2=url.indexOf("&");
  AppendingStringBuffer urlBuf=new AppendingStringBuffer(url.length() + encodedParamReplacement.length());
  urlBuf.append(url.subSequence(0,pos1 + 1));
  urlBuf.append(encodedParamReplacement);
  if (pos2 != -1) {
    urlBuf.append(url.substring(pos2));
  }
  this.url=urlBuf.toString();
}
