{
  tester.startPage(TestErrorPage.class);
  AjaxLink link=(AjaxLink)tester.getComponentFromLastRenderedPage("link");
  try {
    tester.executeAjaxEvent(link,"onclick");
    fail("Excepted an error message to be thrown");
  }
 catch (  IllegalStateException ex) {
    assertEquals(500,((MockHttpServletResponse)tester.getWicketResponse().getHttpServletResponse()).getStatus());
  }
  tester.startPage(TestErrorPage.class);
  try {
    tester.clickLink("link");
    fail("Excepted an error message to be thrown");
  }
 catch (  IllegalStateException ex) {
    assertEquals(500,((MockHttpServletResponse)tester.getWicketResponse().getHttpServletResponse()).getStatus());
  }
}
