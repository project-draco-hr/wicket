{
  checkComponentTag(tag,"applet");
  tag.put("code",HostApplet.class.getName());
  final String jarName=appletClass.getName() + ".jar";
  final ResourceReference jarResourceReference=new ResourceReference(jarName){
    protected Resource newResource(){
      return new ByteArrayResource("application/x-compressed",jarClasses(classes)).setCacheable(false);
    }
  }
;
  String servletPath=((ServletWebRequest)getRequest()).getServletPath();
  tag.put("codebase",servletPath + '/' + Strings.beforeLastPathComponent(jarResourceReference.getPath(),'/')+ "/");
  tag.put("archive",jarName);
  tag.put("name",getPageRelativePath().replace(':','_'));
  final int width=getWidth();
  if (width != -1) {
    tag.put("width",width);
  }
  final int height=getHeight();
  if (height != -1) {
    tag.put("height",height);
  }
  tag.setType(XmlTag.OPEN);
  super.onComponentTag(tag);
}
