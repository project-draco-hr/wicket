{
  if (cookie == null) {
    return null;
  }
  final String comment=settings.getComment();
  if (comment != null) {
    cookie.setComment(comment);
  }
  final String domain=settings.getDomain();
  if (domain != null) {
    cookie.setDomain(domain);
  }
  String path=getWebRequest().getHttpServletRequest().getContextPath();
  if (Strings.isEmpty(path)) {
    path="/";
  }
  cookie.setPath(path);
  cookie.setVersion(settings.getVersion());
  cookie.setSecure(settings.getSecure());
  getWebResponse().addCookie(cookie);
  if (log.isDebugEnabled()) {
    log.debug("Cookie saved: " + cookieToDebugString(cookie) + "; request URI="+ getWebRequest().getHttpServletRequest().getRequestURI());
  }
  return cookie;
}
