{
  if (cookie == null) {
    return null;
  }
 else {
    final String comment=getSettings().getComment();
    if (comment != null) {
      cookie.setComment(comment);
    }
    final String domain=getSettings().getDomain();
    if (domain != null) {
      cookie.setDomain(domain);
    }
    String path=getWebRequest().getHttpServletRequest().getContextPath();
    if (Strings.isEmpty(path)) {
      path="/";
    }
    cookie.setPath(path);
    cookie.setVersion(getSettings().getVersion());
    cookie.setSecure(getSettings().getSecure());
    getWebResponse().addCookie(cookie);
    if (log.isDebugEnabled()) {
      log.debug("Cookie saved: " + cookieToDebugString(cookie) + "; request URI="+ getWebRequest().getHttpServletRequest().getRequestURI());
    }
    return cookie;
  }
}
