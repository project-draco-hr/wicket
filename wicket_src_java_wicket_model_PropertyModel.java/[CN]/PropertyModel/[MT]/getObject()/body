{
  String expr=getExpression();
  if (expr == null || expr.trim().length() == 0) {
    return model.getObject();
  }
  IModel theModel=getModel();
  if (theModel == null) {
    return null;
  }
  Object modelObject=theModel.getObject();
  if (modelObject == null) {
    return null;
  }
  try {
    OgnlContext ctx=getContext();
    Object raw=Ognl.getValue(expr,ctx,modelObject);
    if (applyFormatting) {
      final IStringConverter converter;
      if (component != null) {
        converter=component.getConverter();
      }
 else {
        Session session=Session.get();
        converter=(IStringConverter)session.getConverter();
      }
      return converter.toString(raw);
    }
 else {
      return raw;
    }
  }
 catch (  OgnlException e) {
    throw new WicketRuntimeException(e);
  }
}
