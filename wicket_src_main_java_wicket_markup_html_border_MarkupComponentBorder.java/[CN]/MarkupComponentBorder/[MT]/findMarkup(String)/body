{
  final IResourceStreamFactory locator=Application.get().getResourceSettings().getResourceStreamFactory();
  final Session session=Session.get();
  final String style=session.getStyle();
  final Locale locale=session.getLocale();
  MarkupResourceStream markupResourceStream=null;
  Class containerClass=getClass();
  while (containerClass != MarkupComponentBorder.class) {
    String path=containerClass.getName().replace('.','/');
    IResourceStream resourceStream=locator.newResourceStream(containerClass,path,style,locale,extension);
    if (resourceStream != null) {
      ContainerInfo ci=new ContainerInfo(containerClass,locale,style,null,extension,null);
      markupResourceStream=new MarkupResourceStream(resourceStream,ci,containerClass);
    }
    containerClass=containerClass.getSuperclass();
  }
  MarkupFragment markup;
  try {
    markup=Application.get().getMarkupSettings().getMarkupParserFactory().newMarkupParser(markupResourceStream).readAndParse();
  }
 catch (  Exception e) {
    throw new WicketRuntimeException(e);
  }
  return markup;
}
