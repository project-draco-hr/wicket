{
  StringBuilder result=new StringBuilder();
  boolean first=true;
  for (  String s : getSegments()) {
    if (!first) {
      result.append('/');
    }
    first=false;
    result.append(encodeSegment(s,charset));
  }
  first=true;
  for (  QueryParameter p : getQueryParameters()) {
    if (first) {
      result.append("?");
      first=false;
    }
 else {
      result.append("&");
    }
    result.append(p.toString(charset));
  }
  return result.toString();
}
