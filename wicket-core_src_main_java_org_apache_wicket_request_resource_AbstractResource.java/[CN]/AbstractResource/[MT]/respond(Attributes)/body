{
  ResourceResponse data=newResourceResponse(attributes);
  if (this instanceof IStaticCacheableResource) {
    getCachingStrategy().decorateResponse(data,(IStaticCacheableResource)this);
  }
  setResponseHeaders(data,attributes);
  if (!data.dataNeedsToBeWritten(attributes) || data.getErrorCode() != null) {
    return;
  }
  if (data.getWriteCallback() == null) {
    throw new IllegalStateException("ResourceResponse#setWriteCallback() must be set.");
  }
  data.getWriteCallback().writeData(attributes);
}
