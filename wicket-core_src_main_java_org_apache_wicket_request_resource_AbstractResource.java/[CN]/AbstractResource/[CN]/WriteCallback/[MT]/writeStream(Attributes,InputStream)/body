{
  final Response response=attributes.getResponse();
  OutputStream s=new OutputStream(){
    @Override public void write(    int b) throws IOException {
      response.write(new byte[]{(byte)b});
    }
    @Override public void write(    byte[] b) throws IOException {
      response.write(b);
    }
    @Override public void write(    byte[] b,    int off,    int len) throws IOException {
      if (off == 0 && len == b.length) {
        write(b);
      }
 else {
        byte copy[]=new byte[len];
        System.arraycopy(b,off,copy,0,len);
        write(copy);
      }
    }
  }
;
  try {
    Streams.copy(stream,s);
  }
 catch (  IOException e) {
    throw new WicketRuntimeException(e);
  }
}
