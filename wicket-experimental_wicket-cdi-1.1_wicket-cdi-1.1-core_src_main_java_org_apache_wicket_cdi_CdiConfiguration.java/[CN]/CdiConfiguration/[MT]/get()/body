{
  BeanManager beanManager=CDI.current().getBeanManager();
  Iterator<Bean<?>> iter=beanManager.getBeans(CdiConfiguration.class).iterator();
  if (!iter.hasNext()) {
    throw new IllegalStateException("CDI BeanManager cannot find CdiConfiguration");
  }
  Bean<CdiConfiguration> bean=(Bean<CdiConfiguration>)iter.next();
  CreationalContext<CdiConfiguration> ctx=beanManager.createCreationalContext(bean);
  return (CdiConfiguration)beanManager.getReference(bean,CdiConfiguration.class,ctx);
}
