{
  if (pageMap instanceof AccessStackPageMap) {
synchronized (Session.get()) {
      AccessStackPageMap accessPM=(AccessStackPageMap)pageMap;
      if (accessPM.getVersions() > maxVersions) {
        final AccessStackPageMap.Access oldestAccess=accessPM.getAccessStack().remove(0);
        final IPageMapEntry oldestEntry=pageMap.getEntry(oldestAccess.getId());
        if (oldestEntry instanceof Page) {
          Page page=(Page)oldestEntry;
          if (page.getVersions() > 1) {
            page.expireOldestVersion();
          }
 else {
            accessPM.removeEntry(page);
          }
        }
 else {
          if (oldestEntry != null) {
            accessPM.removeEntry(oldestEntry);
          }
        }
      }
    }
  }
}
