{
  if (pageMap.getVersions() > maxVersions) {
    final List list=pageMap.getEntries();
    IPageMapEntry leastRecentlyUsed=null;
    int min=Integer.MAX_VALUE;
    for (Iterator iterator=list.iterator(); iterator.hasNext(); ) {
      IPageMapEntry entry=(IPageMapEntry)iterator.next();
      int accessSequenceNumber=entry.getAccessSequenceNumber();
      if (accessSequenceNumber < min) {
        min=accessSequenceNumber;
        leastRecentlyUsed=entry;
      }
    }
    if (leastRecentlyUsed != null) {
      if (leastRecentlyUsed instanceof Page) {
        Page page=(Page)leastRecentlyUsed;
        if (page.getVersions() > 1) {
          page.expireOldestVersion();
        }
 else {
          pageMap.remove(page);
        }
      }
 else {
        pageMap.remove(leastRecentlyUsed);
      }
    }
  }
}
