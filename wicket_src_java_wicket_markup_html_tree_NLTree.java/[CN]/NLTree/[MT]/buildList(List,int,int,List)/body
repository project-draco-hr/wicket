{
  int len=visiblePathsList.size();
  while (index < len) {
    TreePath path=(TreePath)visiblePathsList.get(index);
    DefaultMutableTreeNode treeNode=(DefaultMutableTreeNode)path.getLastPathComponent();
    int thisLevel=treeNode.getLevel();
    if (thisLevel > level) {
      List nestedRows=new ArrayList();
      rows.add(nestedRows);
      index=buildList(visiblePathsList,index,thisLevel,nestedRows);
    }
 else     if (thisLevel < level) {
      return index;
    }
 else {
      TreeNodeModel nodeModel=new TreeNodeModel(treeNode,getTreeState(),path);
      rows.add(nodeModel);
      index++;
    }
  }
  return index;
}
