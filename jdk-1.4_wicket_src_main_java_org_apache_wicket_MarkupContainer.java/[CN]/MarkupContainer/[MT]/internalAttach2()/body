{
  if (!getFlag(FLAG_ATTACHED)) {
    setFlag(FLAG_ATTACHING,true);
    visitChildren(new IVisitor(){
      public Object component(      Component component){
        component.setFlag(FLAG_ATTACHING,true);
        return IVisitor.CONTINUE_TRAVERSAL;
      }
    }
);
    setFlag(FLAG_ATTACH_SUPER_CALL_VERIFIED,false);
    onAttach();
    if (!getFlag(FLAG_ATTACH_SUPER_CALL_VERIFIED)) {
      throw new IllegalStateException("Component " + this + " of type "+ getClass().getName()+ " has not been properly attached.  "+ "Something in its class hierarchy has failed to call super.onAttach() in an override of onAttach() method");
    }
    visitChildren(new IVisitor(){
      public Object component(      Component component){
        component.setFlag(FLAG_ATTACH_SUPER_CALL_VERIFIED,false);
        component.onAttach();
        if (!component.getFlag(FLAG_ATTACH_SUPER_CALL_VERIFIED)) {
          throw new IllegalStateException("Component " + component + " of type "+ component.getClass().getName()+ " has not been properly attached.  "+ "Something in its class hierarchy has failed to call super.onAttach() in an override of onAttach() method");
        }
        return IVisitor.CONTINUE_TRAVERSAL;
      }
    }
);
    visitChildren(new IVisitor(){
      public Object component(      Component component){
        component.setFlag(FLAG_ATTACHING,false);
        component.setFlag(FLAG_ATTACHED,true);
        return IVisitor.CONTINUE_TRAVERSAL;
      }
    }
);
    setFlag(FLAG_ATTACHING,false);
    setFlag(FLAG_ATTACHED,true);
  }
}
