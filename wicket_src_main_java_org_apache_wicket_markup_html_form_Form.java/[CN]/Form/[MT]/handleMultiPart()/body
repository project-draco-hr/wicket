{
  if (isMultiPart() && !((WebRequest)getRequest()).isAjax()) {
    try {
      final WebRequest multipartWebRequest=((WebRequest)getRequest()).newMultipartWebRequest(getMaxSize());
      getRequestCycle().setRequest(multipartWebRequest);
    }
 catch (    WicketRuntimeException wre) {
      if (wre.getCause() == null || !(wre.getCause() instanceof FileUploadException)) {
        throw wre;
      }
      FileUploadException e=(FileUploadException)wre.getCause();
      final Map<String,Object> model=new HashMap<String,Object>();
      model.put("exception",e);
      model.put("maxSize",getMaxSize());
      onFileUploadException((FileUploadException)wre.getCause(),model);
      return false;
    }
  }
  return true;
}
