{
  RequestCycle requestCycle=ThreadContext.getRequestCycle();
  if (requestCycle == null)   return resourceReference.getLastModified();
  Map<ResourceReference,Time> cache=requestCycle.getMetaData(TIMESTAMP_KEY);
  if (cache == null) {
    cache=new HashMap<ResourceReference,Time>();
    requestCycle.setMetaData(TIMESTAMP_KEY,cache);
  }
  final Time lastModified;
  if (cache.containsKey(resourceReference)) {
    lastModified=cache.get(resourceReference);
  }
 else {
    lastModified=resourceReference.getLastModified();
    cache.put(resourceReference,lastModified);
  }
  return lastModified;
}
