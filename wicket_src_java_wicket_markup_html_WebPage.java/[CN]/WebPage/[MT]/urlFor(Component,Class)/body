{
  if (!listenerInterface.isAssignableFrom(component.getClass())) {
    throw new WicketRuntimeException("The component " + component + " of class "+ component.getClass()+ " does not implement "+ listenerInterface);
  }
  final WebRequestCycle cycle=getWebRequestCycle();
  final StringBuffer buffer=urlPrefix(cycle);
  appendPageMapName(buffer);
  buffer.append("component=");
  buffer.append(component.getPath());
  if (component.getPage().getCurrentVersionNumber() != 0) {
    buffer.append("&version=");
    buffer.append(component.getPage().getCurrentVersionNumber());
  }
  buffer.append("&interface=");
  buffer.append(Classes.name(listenerInterface));
  if (IEventRequestListener.class.isAssignableFrom(listenerInterface)) {
    buffer.append("&dispatched=true");
  }
  return cycle.getResponse().encodeURL(buffer.toString());
}
