{
  Application app=Application.get();
  if (!(app instanceof PortletApplication)) {
    throw new IllegalStateException(getClass().getName() + " can only operate in the context of portal applications");
  }
  this.application=(PortletApplication)app;
}
