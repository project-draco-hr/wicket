{
  if (!location.startsWith("http://") && !location.startsWith("https://")) {
    String relativeUrl=RequestCycle.get().getRequest().getPath();
    int start=0;
    if (relativeUrl.length() > 0 && relativeUrl.charAt(0) == '/') {
      start=1;
    }
    for (int i=start; i < relativeUrl.length(); i++) {
      if (relativeUrl.charAt(i) == '?') {
        break;
      }
      if (relativeUrl.charAt(i) == '/') {
        b.append("../");
      }
    }
  }
  b.append(location);
}
