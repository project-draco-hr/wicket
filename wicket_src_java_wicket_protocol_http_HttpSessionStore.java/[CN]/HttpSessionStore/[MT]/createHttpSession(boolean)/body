{
  RequestCycle requestCycle=RequestCycle.get();
  if (requestCycle != null) {
    Request request=requestCycle.getRequest();
    if (request instanceof WebRequest) {
      WebRequest webRequest=(WebRequest)request;
      return webRequest.getHttpServletRequest().getSession(createWhenNeeded);
    }
  }
  return null;
}
