{
  long millis=87654321L;
  final ResourceReferenceWithTimestamp reference=new ResourceReferenceWithTimestamp(Time.millis(millis));
  final IRequestHandler handler=new ResourceReferenceRequestHandler(reference,null);
  WicketTester tester=new WicketTester();
  RequestCycle cycle=Mockito.mock(RequestCycle.class);
  ThreadContext.setRequestCycle(cycle);
  Url url1=encoderWithTimestamps.mapHandler(handler);
  assertNotNull(url1);
  assertEquals(1,reference.lastModifiedInvocationCount);
  Url url2=encoderWithTimestamps.mapHandler(handler);
  assertNotNull(url2);
  Url url3=encoderWithTimestamps.mapHandler(handler);
  assertNotNull(url3);
  assertEquals(1,reference.lastModifiedInvocationCount);
  assertEquals(url1,url2);
  assertEquals(url1,url3);
  tester.destroy();
}
