{
  this.filterContext=filterContext;
  HttpServletRequest servletRequest=request.getHttpServletRequest();
  portletConfig=(PortletConfig)servletRequest.getAttribute("javax.portlet.config");
  portletRequest=(PortletRequest)servletRequest.getAttribute("javax.portlet.request");
  portletResponse=(PortletResponse)servletRequest.getAttribute("javax.portlet.response");
  renderResponse=(portletResponse instanceof RenderResponse) ? (RenderResponse)portletResponse : null;
  resourceURLFactory=(PortletResourceURLFactory)portletRequest.getAttribute(WicketPortlet.RESOURCE_URL_FACTORY_ATTR);
  wicketUrlPortletParameter=(String)portletRequest.getAttribute(WicketPortlet.WICKET_URL_PORTLET_PARAMETER_ATTR);
  ajax=request.isAjax();
  resourceRequest="true".equals(servletRequest.getAttribute(WicketPortlet.PORTLET_RESOURCE_URL_ATTR));
  embedded=!(ajax || resourceRequest);
  headerResponse=embedded ? newPortletHeaderResponse(response) : null;
}
