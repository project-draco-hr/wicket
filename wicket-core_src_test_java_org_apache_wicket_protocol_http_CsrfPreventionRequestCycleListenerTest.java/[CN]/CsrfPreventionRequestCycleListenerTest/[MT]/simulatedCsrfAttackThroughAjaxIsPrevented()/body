{
  csrfListener.setConflictingOriginAction(CsrfAction.ABORT);
  tester.addRequestHeader("Origin","http://localhost");
  tester.startPage(ThirdPage.class);
  assertOriginsNotChecked();
  tester.assertRenderedPage(ThirdPage.class);
  tester.addRequestHeader("Origin","http://attacker.com/");
  tester.clickLink("link",true);
  assertConflictingOriginsRequestAborted();
}
