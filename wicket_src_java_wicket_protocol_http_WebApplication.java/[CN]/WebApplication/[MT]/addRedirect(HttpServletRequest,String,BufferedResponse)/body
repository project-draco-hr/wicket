{
  String sessionId=request.getSession(true).getId();
  Map sessionMap=(Map)redirectMap.get(sessionId);
  if (sessionMap == null) {
    sessionMap=new HashMap(4);
    final Time now=Time.now();
    sessionMap.put("last-time-used",now);
synchronized (redirectMap) {
      Iterator it=redirectMap.entrySet().iterator();
      while (it.hasNext()) {
        Map.Entry entry=(Entry)it.next();
        final Time lastTimeUsed=(Time)((Map)entry.getValue()).get("last-time-used");
        if (now.subtract(lastTimeUsed).greaterThan(Duration.minutes(5))) {
          it.remove();
        }
      }
      redirectMap.put(sessionId,sessionMap);
    }
  }
  sessionMap.put(requestUri,renderedResponse);
}
