{
  final StringBuffer buffer=new StringBuffer();
  final Collection choices=getChoices();
  int index=-1;
  Iterator it=choices.iterator();
  while (it.hasNext()) {
    index++;
    final Object choice=it.next();
    final String label=getChoiceRenderer().getDisplayValue(choice);
    if (label != null) {
      buffer.append(getPrefix());
      String id=getChoiceRenderer().getIdValue(choice,index);
      buffer.append("<input name=\"" + getPath() + "\""+ " type=\"radio\""+ (isSelected(choice,index) ? " checked" : "")+ " value=\""+ id+ "\"");
      if (wantOnSelectionChangedNotifications()) {
        final String url=urlFor(IOnChangeListener.class);
        buffer.append(" onclick=\"location.href='" + url + "&"+ getPath()+ "="+ id+ "';\"");
      }
      buffer.append(">");
      String display=getLocalizer().getString(getId() + "." + label,this,label);
      String escaped=Strings.escapeMarkup(display,false,true);
      buffer.append(escaped);
      buffer.append(getSuffix());
    }
  }
  replaceComponentTagBody(markupStream,openTag,buffer.toString());
}
