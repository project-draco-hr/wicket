{
  final List choices=getChoices();
  final AppendingStringBuffer buffer=new AppendingStringBuffer((choices.size() + 1) * 70);
  final String selected=getValue();
  for (int index=0; index < choices.size(); index++) {
    final Object choice=choices.get(index);
    final String label=(String)getConverter().convert(getChoiceRenderer().getDisplayValue(choice),String.class);
    ;
    if (label != null) {
      buffer.append(getPrefix());
      String id=getChoiceRenderer().getIdValue(choice,index);
      final String idAttr=getInputName() + "_" + id;
      buffer.append("<input name=\"" + getInputName() + "\""+ " type=\"radio\""+ (isSelected(choice,index,selected) ? " checked=\"checked\"" : "")+ " value=\""+ id+ "\" id=\""+ idAttr+ "\"");
      if (wantOnSelectionChangedNotifications()) {
        final String url=urlFor(IOnChangeListener.INTERFACE);
        try {
          Form form=getForm();
          buffer.append(" onclick=\"" + form.getJsForInterfaceUrl(url) + ";\"");
        }
 catch (        WicketRuntimeException ex) {
          buffer.append(" onclick=\"" + url + "&"+ getInputName()+ "="+ id+ "';\"");
        }
      }
      buffer.append("/>");
      String display=label;
      if (localizeDisplayValues()) {
        display=getLocalizer().getString(label,this,label);
      }
      String escaped=Strings.escapeMarkup(display,false,true);
      buffer.append("<label for=\"" + idAttr + "\">"+ escaped+ "</label>");
      buffer.append(getSuffix());
    }
  }
  replaceComponentTagBody(markupStream,openTag,buffer.toString());
}
