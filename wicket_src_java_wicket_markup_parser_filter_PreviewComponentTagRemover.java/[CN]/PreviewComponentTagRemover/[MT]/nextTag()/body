{
  final ComponentTag openTag=(ComponentTag)getParent().nextTag();
  if (openTag == null) {
    return openTag;
  }
  if (!(openTag instanceof ComponentWicketTag) || !((ComponentWicketTag)openTag).isRemoveTag()) {
    return openTag;
  }
  if (openTag.isOpenClose()) {
    throw new MarkupException("Wicket remove tag must not be an open-close tag: " + openTag.toUserDebugString());
  }
  ComponentTag closeTag;
  while (null != (closeTag=(ComponentTag)getParent().nextTag())) {
    if (closeTag.getComponentName() == null) {
      continue;
    }
    if (closeTag.closes(openTag)) {
      openTag.setComponentName(IGNORE);
      return openTag;
    }
    throw new MarkupException("Markup remove regions must not contain Wicket component tags. " + "tag: " + closeTag.toUserDebugString());
  }
  throw new MarkupException("Did not find close tag for markup remove region. " + "Open tag: " + openTag.toUserDebugString());
}
