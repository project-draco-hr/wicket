{
  while (!stop) {
    try {
      while (pagesToBeSaved.size() == 0) {
        Thread.sleep(getSleepTimeMs());
        if (stop)         return;
      }
      Iterator it=pagesToBeSaved.entrySet().iterator();
      while (it.hasNext()) {
        Map.Entry entry=(Entry)it.next();
        SessionPageKey key=(SessionPageKey)entry.getKey();
        if (key.data instanceof byte[]) {
          savePage(key,(byte[])key.data);
        }
        it.remove();
      }
    }
 catch (    Exception e) {
      log.error("Error in page save thread",e);
    }
  }
}
