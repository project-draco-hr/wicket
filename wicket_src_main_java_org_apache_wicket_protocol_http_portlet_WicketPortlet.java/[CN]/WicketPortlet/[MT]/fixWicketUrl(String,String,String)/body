{
  if (url == null) {
    return wicketFilterPath;
  }
 else   if (!url.startsWith(wicketFilterPath)) {
    if ((url + "/").equals(wicketFilterPath)) {
      url=wicketFilterPath;
    }
 else     if (url.startsWith(wicketFilterQuery)) {
      url=wicketFilterPath + "?" + url.substring(wicketFilterQuery.length());
    }
  }
  return url;
}
