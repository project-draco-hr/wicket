{
  String wicketURL=null;
  String wicketUrlParameterName=(String)request.getAttribute(WicketPortlet.WICKET_URL_PORTLET_PARAMETER_ATTR);
  if (request instanceof ActionRequest) {
    wicketURL=request.getParameter(wicketUrlParameterName);
  }
 else   if (request instanceof ResourceRequest) {
    wicketURL=((ResourceRequest)request).getResourceID();
  }
 else {
    String parameterName=wicketUrlParameterName + request.getPortletMode().toString();
    wicketURL=request.getParameter(parameterName);
  }
  if (wicketURL == null) {
    wicketURL=getWicketConfigParameter(request,CONFIG_PARAM_PREFIX + pageType,defaultPage);
  }
  return wicketURL;
}
