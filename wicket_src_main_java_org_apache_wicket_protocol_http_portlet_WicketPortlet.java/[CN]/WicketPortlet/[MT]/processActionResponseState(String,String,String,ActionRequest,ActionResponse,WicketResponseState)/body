{
  if (responseState.getRedirectLocation() != null) {
    wicketURL=fixWicketUrl(responseState.getRedirectLocation(),wicketFilterPath,wicketFilterQuery);
    if (wicketURL.startsWith(wicketFilterPath)) {
      response.setRenderParameter((String)request.getAttribute(WicketPortlet.WICKET_URL_PORTLET_PARAMETER_ATTR) + request.getPortletMode().toString(),wicketURL);
    }
 else {
      response.sendRedirect(responseState.getRedirectLocation());
    }
  }
}
