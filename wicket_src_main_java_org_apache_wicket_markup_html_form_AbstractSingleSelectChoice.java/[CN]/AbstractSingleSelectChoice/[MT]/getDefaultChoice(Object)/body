{
  final Object noSelectionValue=getNoSelectionValue();
  if (isNullValid()) {
    String option=getLocalizer().getStringIgnoreSettings(getNullValidKey(),this,null,null);
    if (Strings.isEmpty(option)) {
      option=getLocalizer().getString("nullValid",this,"");
    }
    final AppendingStringBuffer buffer=new AppendingStringBuffer(64 + option.length());
    buffer.append("\n<option");
    if (selected == noSelectionValue) {
      buffer.append(" selected=\"selected\"");
    }
    buffer.append(" value=\"" + noSelectionValue + "\">").append(option).append("</option>");
    return buffer;
  }
 else {
    if ((selected == null) || selected.equals(noSelectionValue) || selected.equals(EMPTY_STRING)) {
      String option=getLocalizer().getStringIgnoreSettings(getNullKey(),this,null,null);
      if (Strings.isEmpty(option)) {
        option=getLocalizer().getString("null",this,CHOOSE_ONE);
      }
      return "\n<option selected=\"selected\" value=\"" + noSelectionValue + "\">"+ option+ "</option>";
    }
  }
  return "";
}
