{
  if (tag.getId().equals(HtmlHeaderSectionHandler.HEADER_ID)) {
    return newHtmlHeaderContainer(HtmlHeaderSectionHandler.HEADER_ID + container.getPage().getAutoIndex());
  }
 else   if ((tag instanceof WicketTag) && ((WicketTag)tag).isHeadTag()) {
    if (container instanceof WebPage) {
      MarkupContainer header=newHtmlHeaderContainer(HtmlHeaderSectionHandler.HEADER_ID + container.getPage().getAutoIndex());
      WebMarkupContainer header2=new TransparentWebMarkupContainer(HtmlHeaderSectionHandler.HEADER_ID);
      header2.setRenderBodyOnly(true);
      header.add(header2);
      return header;
    }
 else     if (container instanceof HtmlHeaderContainer) {
      WebMarkupContainer header=new TransparentWebMarkupContainer(HtmlHeaderSectionHandler.HEADER_ID);
      header.setRenderBodyOnly(true);
      return header;
    }
    final Page page=container.getPage();
    final String pageClassName=(page != null) ? page.getClass().getName() : "unknown";
    final IResourceStream stream=markupStream.getResource();
    final String streamName=(stream != null) ? stream.toString() : "unknown";
    throw new MarkupException("Mis-placed <wicket:head>. <wicket:head> must be outside of <wicket:panel>, <wicket:border>, and <wicket:extend>. Error occured while rendering page: " + pageClassName + " using markup stream: "+ streamName);
  }
  return null;
}
