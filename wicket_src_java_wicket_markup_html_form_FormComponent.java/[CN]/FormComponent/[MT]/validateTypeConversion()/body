{
  if (type == null) {
    convertedInput=getInput();
  }
 else   if (!Strings.isEmpty(getInput())) {
    final IConverter converter=getConverter();
    try {
      convertedInput=converter.convert(getInput(),type);
    }
 catch (    ConversionException e) {
      Map args=new HashMap();
      args.put("type",Classes.simpleName(type));
      final Locale locale=e.getLocale();
      if (locale != null) {
        args.put("locale",locale);
      }
      args.put("exception",e);
      Format format=e.getFormat();
      if (format instanceof SimpleDateFormat) {
        args.put("format",((SimpleDateFormat)format).toLocalizedPattern());
      }
      final String typedResourceKey="TypeValidator" + "." + Classes.simpleName(type);
      String[] resourceKeys=new String[]{typedResourceKey,"TypeValidator"};
      error(Arrays.asList(resourceKeys),args);
    }
  }
}
