{
  if (type == null) {
    try {
      convertedInput=convertValue(getInputAsArray());
    }
 catch (    ConversionException e) {
      Map<String,Serializable> args=new HashMap<String,Serializable>();
      final Locale locale=e.getLocale();
      if (locale != null) {
        args.put("locale",locale);
      }
      args.put("exception",e);
      Format format=e.getFormat();
      if (format instanceof SimpleDateFormat) {
        args.put("format",((SimpleDateFormat)format).toLocalizedPattern());
      }
      String[] resourceKeys=null;
      if (e.getTargetType() != null) {
        String typedResourceKey="ConversionError." + Classes.simpleName(e.getTargetType());
        resourceKeys=new String[]{typedResourceKey,"ConversionError"};
      }
 else {
        resourceKeys=new String[]{"ConversionError"};
      }
      error(Arrays.asList(resourceKeys),args);
    }
  }
 else   if (!Strings.isEmpty(getInput())) {
    final IConverter converter=getConverter(type);
    try {
      convertedInput=(T)converter.convertToObject(getInput(),getLocale());
    }
 catch (    ConversionException e) {
      Map<String,Serializable> args=new HashMap<String,Serializable>();
      args.put("type",Classes.simpleName(type));
      final Locale locale=e.getLocale();
      if (locale != null) {
        args.put("locale",locale);
      }
      args.put("exception",e);
      Format format=e.getFormat();
      if (format instanceof SimpleDateFormat) {
        args.put("format",((SimpleDateFormat)format).toLocalizedPattern());
      }
      final String typedResourceKey="TypeValidator." + Classes.simpleName(type);
      String[] resourceKeys=new String[]{typedResourceKey,"TypeValidator"};
      error(Arrays.asList(resourceKeys),args);
    }
  }
}
