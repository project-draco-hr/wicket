{
  if (getModelObject() instanceof ExtendedTreeModel) {
    return ((ExtendedTreeModel)getModelObject()).getParent(node);
  }
 else   if (node instanceof TreeNode) {
    return ((TreeNode)node).getParent();
  }
 else {
    throw new IllegalStateException("Couldn't determine node parent. Either the tree model must implement ParentTreeModel or Node must implement TreeNode.");
  }
}
