{
  super(request);
  final String secureParam=request.getParameter("x");
  if ((secureParam != null) && (secureParam.length() > 0)) {
    ICrypt urlCrypt=Application.get().getSecuritySettings().getCryptFactory().newCrypt();
    final String queryString=urlCrypt.decryptUrlSafe(secureParam);
    this.queryString=rebuildUrl(queryString);
    this.parameters=new PageParameters();
    RequestUtils.decodeParameters(this.queryString,this.parameters);
  }
 else {
    this.queryString=null;
    this.parameters=new ValueMap();
  }
  final Enumeration paramNames=request.getParameterNames();
  while (paramNames.hasMoreElements()) {
    String paramName=(String)paramNames.nextElement();
    if (!"x".equalsIgnoreCase(paramName)) {
      String[] values=request.getParameterValues(paramName);
      this.parameters.put(paramName,values);
    }
  }
}
