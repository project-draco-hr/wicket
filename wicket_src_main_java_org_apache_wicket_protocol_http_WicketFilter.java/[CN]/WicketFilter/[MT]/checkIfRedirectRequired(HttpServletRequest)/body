{
  String requestURI=request.getRequestURI();
  String contextPath=request.getContextPath();
  int uriLength=requestURI.indexOf(';');
  if (uriLength == -1) {
    uriLength=requestURI.length();
  }
  if (filterPathLength == -1) {
    filterPathLength=filterPath.length();
    if (filterPath.endsWith("/")) {
      filterPathLength-=1;
    }
  }
  if (uriLength != (contextPath.length() + 1 + filterPathLength)) {
    return null;
  }
  String uri=requestURI.substring(0,uriLength);
  String homePageUri=contextPath + "/" + filterPath.substring(0,filterPathLength);
  if (uri.equals(homePageUri) == false) {
    return null;
  }
  uri+="/";
  if (!Strings.isEmpty(request.getQueryString())) {
    uri+="?" + request.getQueryString();
  }
  return uri;
}
