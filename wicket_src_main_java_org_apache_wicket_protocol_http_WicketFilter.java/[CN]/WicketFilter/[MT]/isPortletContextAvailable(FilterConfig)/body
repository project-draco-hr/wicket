{
  boolean detectPortletContext=false;
  String parameter=config.getInitParameter(DETECT_PORTLET_CONTEXT);
  if (parameter != null) {
    detectPortletContext=Boolean.valueOf(parameter).booleanValue();
  }
 else {
    parameter=config.getServletContext().getInitParameter(DETECT_PORTLET_CONTEXT_FULL_NAME);
    if (parameter != null) {
      detectPortletContext=Boolean.valueOf(parameter).booleanValue();
    }
 else {
      InputStream is=Thread.currentThread().getContextClassLoader().getResourceAsStream(WICKET_PORTLET_PROPERTIES);
      if (is != null) {
        try {
          Properties properties=new Properties();
          properties.load(is);
          detectPortletContext=Boolean.valueOf(properties.getProperty(DETECT_PORTLET_CONTEXT_FULL_NAME,"false")).booleanValue();
        }
 catch (        IOException e) {
          throw new ServletException("Failed to load WicketPortlet.properties from classpath",e);
        }
      }
    }
  }
  if (detectPortletContext) {
    try {
      Class portletClass=Class.forName("javax.portlet.PortletContext");
      return true;
    }
 catch (    ClassNotFoundException e) {
    }
  }
  return false;
}
