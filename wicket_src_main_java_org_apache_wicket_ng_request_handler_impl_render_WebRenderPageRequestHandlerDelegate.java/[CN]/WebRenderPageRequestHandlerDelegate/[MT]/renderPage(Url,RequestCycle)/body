{
  final Response originalResponse=requestCycle.getResponse();
  BufferedWebResponse response=new BufferedWebResponse(){
    @Override public String encodeURL(    CharSequence url){
      return originalResponse.encodeURL(url).toString();
    }
  }
;
  Url originalBaseUrl=requestCycle.getUrlRenderer().setBaseUrl(targetUrl);
  try {
    requestCycle.setResponse(response);
    getPage().renderPage();
    return response;
  }
  finally {
    requestCycle.setResponse(originalResponse);
    requestCycle.getUrlRenderer().setBaseUrl(originalBaseUrl);
  }
}
