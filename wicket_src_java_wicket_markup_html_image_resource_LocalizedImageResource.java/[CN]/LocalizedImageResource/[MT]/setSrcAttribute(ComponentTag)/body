{
  if (resourceKind == null && (!Objects.equal(locale,component.getLocale()) || !Objects.equal(style,component.getStyle()))) {
    this.locale=component.getLocale();
    this.style=component.getStyle();
    this.resourceReference=null;
    this.resource=null;
  }
  if (resource == null && resourceReference == null) {
    final String src=tag.getString("src");
    if (src != null) {
      loadStaticImage(src);
    }
 else {
      final String value=tag.getString("value");
      if (value != null) {
        newImage(value);
      }
 else {
        loadStaticImage(component.getModelObjectAsString());
      }
    }
  }
  final String url;
  if (this.resourceReference != null) {
    url=RequestCycle.get().urlFor(resourceReference);
  }
 else {
    url=component.urlFor(Resource.RESOURCE_LISTENER_INTERFACE);
  }
  tag.put("src",Strings.replaceAll(component.getResponse().encodeURL(url),"&","&amp;"));
}
