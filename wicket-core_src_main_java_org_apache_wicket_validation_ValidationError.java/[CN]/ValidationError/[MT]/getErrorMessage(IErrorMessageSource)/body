{
  String errorMessage=null;
  for (  String key : keys) {
    errorMessage=messageSource.getMessage(key);
    if (errorMessage != null) {
      break;
    }
  }
  if (errorMessage == null && message != null) {
    errorMessage=message;
  }
  if (errorMessage != null) {
    final Map<String,Object> p=(vars != null) ? vars : EMPTY_VARS;
    errorMessage=messageSource.substitute(errorMessage,p);
  }
  return errorMessage;
}
