{
  currentMarkupStream=markupStream;
  currentOpenTag=openTag;
  final Reader templateReader=getTemplateReader();
  if (templateReader != null) {
    String result=evaluateVelocityTemplate(templateReader);
    if (!parseGeneratedMarkup()) {
      replaceComponentTagBody(markupStream,openTag,result);
    }
 else {
      Markup markup=getMarkup(result);
      markupStream.skipRawMarkup();
      renderAll(new MarkupStream(markup));
    }
  }
 else {
    replaceComponentTagBody(markupStream,openTag,"");
  }
}
