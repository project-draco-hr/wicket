{
  String key=getDefaultModelObjectAsString();
  if (Strings.isEmpty(key)) {
    throw new WicketRuntimeException("Expected the model object to contain the message key. But the model object was null");
  }
  IMarkupFragment markup=getParent().getMarkup(null);
  for (int i=0; i < markup.size(); i++) {
    MarkupElement elem=markup.get(i);
    if (elem instanceof WicketTag) {
      WicketTag tag=(WicketTag)elem;
      if (tag.isMessageTag() && key.equals(tag.getAttribute("key"))) {
        return new MarkupFragment(markup,i);
      }
    }
  }
  return null;
}
